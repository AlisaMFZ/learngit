{"version":3,"sources":["index.js"],"names":[],"mappings":";;;;;;;;;;;;AAAA,IAAI,iBAAiB,QAAQ,MAAR,CAAe,OAAf,IAA0B,GAA/C;AACA,IAAI,aAAa,EAAjB;;AAEA,IAAI,YAAJ;AACA,IAAI,YAAJ;;AAEA,IAAI,WAAW,iCAAf;AACA,IAAI,YAAY,yCAAhB;AACA,IAAI,iBAAiB,OAAO,SAAP,CAAiB,cAAtC;;AAEA,SAAS,YAAT,CAAsB,GAAtB,EAA0B;AACxB,SAAO,IACJ,OADI,CACI,SADJ,EACe,EADf,EAEJ,OAFI,CAEI,QAFJ,EAEc,GAFd,EAGJ,MAHH;AAID;;AAED,SAAS,QAAT,CAAkB,IAAlB,EAAuB;AACrB,SAAO,KAAK,OAAL,CAAa,OAAb,EAAsB,UAAS,CAAT,EAAY,EAAZ,EAAe;AAC1C,WAAO,GAAG,WAAH,EAAP;AACD,GAFM,CAAP;AAGD;;AAED,SAAS,MAAT,CAAgB,IAAhB,EAAsB,MAAtB,EAA6B;AAC3B,OAAK,IAAI,GAAT,IAAgB,MAAhB;AACE,QAAI,eAAe,IAAf,CAAoB,MAApB,EAA4B,GAA5B,CAAJ,EACE,KAAK,GAAL,IAAY,OAAO,GAAP,CAAZ;AAFJ,GAIA,OAAO,IAAP;AACD;;AAED,SAAS,cAAT,CAAwB,KAAxB,EAA8B;AAC5B,SAAO,KAAP;AACD;;AAED,SAAS,GAAT,CAAa,KAAb,EAAoB,GAApB,EAAwB;AACtB,SAAO,MAAM,MAAM,KAAK,GAAL,CAAS,CAAT,EAAY,QAAQ,aAAa,GAAb,CAApB,IAAyC,CAA/C,EAAkD,IAAlD,CAAuD,GAAvD,CAAb;AACD;;AAED,SAAS,IAAT,GAAe;AACb;AACD;;AAED,SAAS,WAAT,CAAqB,GAArB,EAAyB;AACvB;AACA;AACA;AACA,MAAI,GAAJ;AACA,MAAI,OAAO,IAAI,IAAJ,EAAX;AACA,MAAI,SAAS;AACX,kBAAc,CADH;AAEX,kBAAc,CAFH;AAGX,UAAM;AAHK,GAAb;;AAMA,KAAG;AACD,UAAM,IAAN;AACA,WAAO,KAAK,OAAL,CAAa,kCAAb,EAAiD,UAAS,CAAT,EAAY,IAAZ,EAAiB;AACvE,aAAO,IAAP,CAAY,IAAZ,CAAiB,IAAI,QAAJ,CAAa,IAAb,EAAmB,IAAnB,CAAjB;AACA,aAAO,YAAP;AACA,aAAO,YAAP;;AAEA,aAAO,EAAP;AACD,KANM,CAAP;AAOD,GATD,QAUO,OAAO,IAVd;;AAYA,KAAG;AACD,UAAM,IAAN;AACA,WAAO,KAAK,OAAL,CAAa,oCAAb,EAAmD,UAAS,CAAT,EAAY,IAAZ,EAAiB;AACzE,aAAO,IAAP,CAAY,IAAZ,CAAiB,IAAI,QAAJ,CAAa,IAAb,EAAmB,KAAnB,CAAjB;AACA,aAAO,YAAP;;AAEA,aAAO,EAAP;AACD,KALM,CAAP;AAMD,GARD,QASO,OAAO,IATd;;AAWA,MAAI,IAAJ,EACE,MAAM,IAAI,WAAJ,CAAgB,gCAAgC,GAAhD,CAAN;;AAEF,SAAO,OAAO,IAAP,CAAY,MAAZ,GAAqB,MAArB,GAA8B,KAArC;AACD;;AAED;;;;AAIA,IAAI,cAAc,SAAd,WAAc,CAAS,OAAT,EAAiB;AACjC,OAAK,OAAL,GAAe,OAAf;AACD,CAFD;AAGA,YAAY,SAAZ,GAAwB,sBAAc,MAAM,SAApB,CAAxB;AACA,YAAY,SAAZ,CAAsB,IAAtB,GAA6B,aAA7B;AACA,YAAY,SAAZ,CAAsB,IAAtB,GAA6B,IAA7B;;AAEA;;;AAGA,IAAI,WAAW,SAAX,QAAW,CAAS,IAAT,EAAe,QAAf,EAAwB;AACrC,OAAK,IAAL,GAAY,IAAZ;AACA,OAAK,QAAL,GAAgB,QAAhB;AACD,CAHD;AAIA,SAAS,SAAT,GAAqB;AACnB,YAAU,KADS;AAEnB,QAAM,EAFa;AAGnB,aAAW,cAHQ;AAInB,WAAS,mBAAU;AACjB,WAAO,EAAP;AACD;AANkB,CAArB;;AASA;;;;;AAKA,IAAI,SAAS,SAAT,MAAS,CAAS,KAAT,EAAgB,WAAhB,EAA4B;AACvC,MAAI,OAAO,IAAX;AACA,MAAI,MAAJ;AACA,MAAI,OAAO,MAAM,IAAN;AACT;AACA;AAFS,GAGR,OAHQ,CAGA,6BAHA,EAG+B,UAAS,CAAT,EAAY,IAAZ,EAAiB;AACvD,SAAK,KAAL,GAAa,IAAb;;AAEA,WAAO,EAAP;AACD,GAPQ;AAQT;AACA;AACA;AAVS,GAWR,OAXQ,CAWA,kCAXA,EAWoC,UAAS,CAAT,EAAY,IAAZ,EAAiB;AAC5D,SAAK,IAAL,GAAY,IAAZ;AACA,SAAK,IAAL,GAAY,KAAK,OAAL,CAAa,UAAb,EAAyB,IAAzB,CAAZ;AACA,SAAK,QAAL,GAAgB,KAAK,IAAL,IAAa,KAAK,IAAlC;;AAEA,WAAO,EAAP;AACD,GAjBQ,CAAX;;AAmBA,MAAI,CAAC,KAAK,IAAV,EACE,MAAM,IAAI,WAAJ,CAAgB,6BAA6B,KAA7C,CAAN;;AAEF,MAAI;AACF,aAAS,YAAY,IAAZ,CAAT;AACD,GAFD,CAEE,OAAM,CAAN,EAAS;AACT,UAAM,IAAI,WAAJ,CAAgB,qDAAqD,KAArE,EAA4E,CAA5E,CAAN;AACD;;AAED,MAAI,MAAJ,EACA;AACE,WAAO,EAAP;AACA,SAAK,IAAL,GAAY,KAAK,IAAjB;AACA,SAAK,QAAL,GAAgB,SAAhB;;AAEA,WAAO,IAAP,EAAa,MAAb;AACD;;AAED,MAAI,IAAJ,EACE,MAAM,IAAI,WAAJ,CAAgB,uCAAuC,KAAvD,CAAN;;AAEF,MAAI,CAAC,KAAK,IAAV,EACE,KAAK,IAAL,GAAY,KAAK,IAAjB;;AAEF,OAAK,WAAL,GAAmB,eAAe,EAAlC;AACA,OAAK,KAAL,GAAa,MAAM,IAAN,EAAb;AACA,OAAK,SAAL,GAAiB,SAAS,KAAK,IAAd,CAAjB;AACD,CAjDD;;AAmDA,OAAO,SAAP,GAAmB;AACjB,QAAM,EADW;AAEjB,eAAa,EAFI;AAGjB,SAAO,EAHU;AAIjB,QAAM,EAJW;;AAMjB,cAAY,KANK;AAOjB,YAAU,KAPO;AAQjB,gBAAc,CARG;AASjB,gBAAc,CATG;AAUjB,QAAM,IAVW;;AAYjB,YAAU,SAZO;AAajB,aAAW;AAbM,CAAnB;;AAiBA;AACA;AACA;;AAEA,SAAS,YAAT,CAAsB,KAAtB,EAA6B,WAA7B,EAA0C,KAA1C,EAAiD,KAAjD,EAAuD;AACrD,MAAI,SAAS,IAAI,MAAJ,CAAW,KAAX,EAAkB,WAAlB,CAAb;;AAEA;AACA;;AAEA,MAAI,UAAU,MAAV,IAAoB,CAAxB,EACA;AACE,QAAI,SAAS,MAAM,WAAN,KAAsB,MAAnC,EACA;AACE,WAAK,IAAI,GAAT,IAAgB,KAAhB;AACE,YAAI,OAAO,WAAP,IACA,OAAO,UADP,IAEA,OAAO,YAFX,EAGE,OAAO,GAAP,IAAc,MAAM,GAAN,CAAd;AAJJ,OADF,CAOE;AACA,UAAI,MAAM,GAAV,EACE,OAAO,UAAP,GAAoB,IAApB;AACH,KAXD,MAaA;AACE,UAAI,OAAO,KAAP,IAAgB,UAApB,EACE,OAAO,SAAP,GAAmB,KAAnB,CADF,KAGE,OAAO,QAAP,GAAkB,KAAlB;AACH;AACF;;AAED,MAAI,UAAU,MAAV,IAAoB,CAAxB,EACA;AACE,QAAI,OAAO,KAAP,IAAgB,UAApB,EACE,OAAO,SAAP,GAAmB,KAAnB;;AAEF,WAAO,QAAP,GAAkB,KAAlB;AACD;;AAED,SAAO,MAAP;AACD;;AAED,SAAS,kBAAT,CAA4B,OAA5B,EAAqC,MAArC,EAA4C;AAC1C,MAAI,aAAJ;;AAEA;AACA,MAAI,OAAO,KAAX,EACA;AACE,oBAAgB,QAAQ,KAAR,CAAc,OAAO,KAArB,CAAhB;;AAEA,QAAI,aAAJ,EACE,MAAM,IAAI,WAAJ,CAAgB,wBAAwB,OAAO,KAA/B,GAAuC,qBAAvC,GAA+D,cAAc,KAA7E,GAAqF,GAArF,GAA2F,cAAc,WAAzH,CAAN;;AAEF,YAAQ,KAAR,CAAc,OAAO,KAArB,IAA8B,MAA9B;AACD;;AAED;AACA,kBAAgB,QAAQ,IAAR,CAAa,OAAO,IAApB,CAAhB;;AAEA,MAAI,aAAJ,EACE,MAAM,IAAI,WAAJ,CAAgB,mBAAmB,OAAO,IAA1B,GAAiC,qBAAjC,GAAyD,cAAc,KAAvE,GAA+E,GAA/E,GAAqF,cAAc,WAAnH,CAAN;;AAEF,UAAQ,IAAR,CAAa,OAAO,IAApB,IAA4B,MAA5B;;AAEA;AACA,kBAAgB,QAAQ,OAAR,CAAgB,OAAO,SAAvB,CAAhB;;AAEA,MAAI,aAAJ,EACE,MAAM,IAAI,WAAJ,CAAgB,iBAAiB,OAAO,SAAxB,GAAoC,qBAApC,GAA4D,cAAc,KAA1E,GAAkF,GAAlF,GAAwF,cAAc,WAAtH,CAAN;;AAEF,UAAQ,OAAR,CAAgB,OAAO,SAAvB,IAAoC,MAApC;;AAEA;AACA,MAAI,OAAO,OAAO,QAAd,IAA0B,WAA9B,EACE,QAAQ,SAAR,CAAkB,OAAO,SAAzB,EAAoC,OAAO,QAA3C,EAAqD,IAArD;;AAEF;AACA,UAAQ,WAAR,CAAoB,IAApB,CAAyB,OAAO,OAAO,IAAvC;;AAEA,SAAO,MAAP;AACD;;AAED,SAAS,YAAT,CAAsB,GAAtB,EAA2B,KAA3B,EAAiC;AAC/B,SAAO,IAAI,WAAJ,CAAgB,MAAhB,CAAuB,UAAS,IAAT,EAAc;AAC1C,WAAO,KAAK,MAAL,CAAY,CAAZ,EAAe,MAAM,MAArB,KAAgC,KAAvC;AACD,GAFM,CAAP;AAGD;;AAED,SAAS,WAAT,CAAqB,OAArB,EAA8B,IAA9B,EAAoC,OAApC,EAA4C;AAC1C,WAAS,aAAT,CAAuB,MAAvB,EAA+B,OAA/B,EAAuC;AACrC,QAAI,SAAS,EAAb;;AAEA,QAAI,OAAO,YAAX,EACA;AACE,WAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,OAAO,YAA3B,EAAyC,GAAzC,EACA;AACE,YAAI,eAAe,WAAW,IAAI,CAAJ,GAAQ,CAAR,IAAa,KAAK,MAAL,GAAc,CAAzD;AACA,YAAI,YAAY,KAAK,IAAI,CAAT,CAAhB;;AAEA;AACA,YAAI,YAAJ,EACA;AACE;AACA,0BAAgB,IAAhB;AACA,cAAI,KAAK,MAAT;AACA;AACD;;AAED,YAAI,CAAC,SAAD,IAAc,UAAU,CAAV,KAAgB,GAAlC,EACE;;AAEF,eAAO,IAAP,CAAY,KAAK,EAAE,CAAP,CAAZ;AACD;;AAED,UAAI,OAAO,MAAP,GAAgB,OAAO,YAA3B,EACE,MAAM,IAAI,WAAJ,CAAgB,YAAY,KAAZ,GAAoB,gCAApB,GAAuD,OAAO,YAA9D,GAA6E,uBAA7E,GAAuG,OAAO,KAA9H,CAAN;AACH,KAxBD,MA0BA;AACE,eAAS,CAAC,OAAO,QAAjB;AACD;;AAED;AACA,gBAAY,OAAZ,CAAoB,IAApB,CAAyB;AACvB,cAAQ,MADe;AAEvB,aAAO;AAFgB,KAAzB;AAID;;AAED,MAAI,cAAc;AAChB,aAAS,OADO;AAEhB,UAAM,EAFU;AAGhB,iBAAa,EAHG;AAIhB,aAAS;AAJO,GAAlB;AAMA,MAAI,SAAS,CAAC,WAAD,CAAb;;AAEA,MAAI,oBAAoB,EAAxB;AACA,MAAI,gBAAgB,KAApB;AACA,MAAI,cAAc,KAAlB;AACA,MAAI,cAAc,EAAlB;AACA,MAAI,eAAe,IAAnB;AACA,MAAI,MAAJ;;AAEA,iBAAe,CAAC,QAAQ,IAAT,CAAf;;AAEA,OAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,KAAK,MAAzB,EAAiC,GAAjC,EACA;AACE,QAAI,eAAe,WAAW,KAAK,KAAK,MAAL,GAAc,CAAjD;AACA,QAAI,QAAQ,KAAK,CAAL,CAAZ;;AAEA,QAAI,WAAJ,EACA;AACE,kBAAY,IAAZ,CAAiB,KAAjB;AACA;AACD;;AAED,QAAI,iBAAiB,SAAS,IAAT,IAAiB,SAAS,GAA1B,IAAiC,MAAM,CAAN,KAAY,GAA9D,CAAJ,EACA;AACE,0BAAoB,KAApB;AACA,YAFF,CAES;AACR;;AAED,QAAI,SAAS,IAAb,EACA;AACE,qBAAe,KAAf;AACA,oBAAc,IAAd;AACA;AACD;;AAED,QAAI,MAAM,CAAN,KAAY,GAAhB,EACA;AACE,qBAAe,KAAf;;AAEA,UAAI,YAAY,MAAhB,EACA;AACE;AACA,oBAAY,IAAZ,GAAmB,WAAnB;AACA,sBAAc,EAAd;AACD;;AAED,UAAI,MAAM,CAAN,KAAY,GAAhB,EACA;AACE;AACA,iBAAS,QAAQ,IAAR,CAAa,MAAM,MAAN,CAAa,CAAb,CAAb,CAAT;;AAEA,YAAI,CAAC,MAAL,EACA;AACE;AACA,cAAI,YAAJ,EACE,OAAO,aAAa,OAAb,EAAsB,KAAtB,CAAP,CADF,KAGE,MAAM,IAAI,WAAJ,CAAgB,qBAAqB,KAArC,CAAN;AACH;;AAED;AACA,sBAAc,MAAd,EAAsB,OAAtB;AACD,OAhBD,MAkBA;AACE;AACA,YAAI,CAAC,eAAe,IAAf,CAAoB,KAApB,CAAL,EACE,MAAM,IAAI,WAAJ,CAAgB,kCAAkC,KAAlD,CAAN;;AAEF,YAAI,MAAM,MAAN,IAAgB,CAApB,EACA;AACE,mBAAS,QAAQ,KAAR,CAAc,MAAM,CAAN,CAAd,CAAT;;AAEA,cAAI,CAAC,MAAL,EACE,MAAM,IAAI,WAAJ,CAAgB,iCAAiC,MAAM,CAAN,CAAjD,CAAN;;AAEF;AACA,wBAAc,MAAd,EAAsB,OAAtB;AACD,SATD,MAWA;AACE;AACA,eAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,MAAM,MAA1B,EAAkC,GAAlC,EACA;AACE,qBAAS,QAAQ,KAAR,CAAc,MAAM,CAAN,CAAd,CAAT;;AAEA,gBAAI,CAAC,MAAL,EACE,MAAM,IAAI,WAAJ,CAAgB,iCAAiC,MAAM,CAAN,CAAjD,CAAN;;AAEF,gBAAI,OAAO,YAAX,EACE,MAAM,IAAI,WAAJ,CAAgB,yBAAyB,MAAM,CAAN,CAAzB,GAAoC,4CAApC,GAAmF,KAAnG,CAAN;;AAEF,0BAAc,MAAd,EAAsB,OAAtB;AACD;AACF;AACF;AACF,KA7DD,MA+DA;AACE,UAAI,QAAQ,QAAR,CAAiB,KAAjB,MAA4B,CAAC,QAAQ,MAAT,IAAmB,YAAY,MAAZ,IAAsB,QAAQ,MAAR,CAAe,YAApF,CAAJ,EACA;AACE,YAAI,YAAJ,EACA;AACE,sBAAY,IAAZ,GAAmB,WAAnB;AACA,wBAAc,EAAd;AACD;;AAED,YAAI,QAAQ,MAAR,IAAkB,YAAY,IAAZ,CAAiB,MAAjB,GAA0B,QAAQ,MAAR,CAAe,YAA/D,EACE,MAAM,IAAI,WAAJ,CAAgB,8CAA8C,QAAQ,IAAtD,GAA6D,GAA7E,CAAN;;AAEF;AACA,kBAAU,QAAQ,QAAR,CAAiB,KAAjB,CAAV;AACA,uBAAe,IAAf;;AAEA,qBAAa,IAAb,CAAkB,QAAQ,IAA1B;;AAEA,sBAAc;AACZ,mBAAS,OADG;AAEZ,gBAAM,EAFM;AAGZ,uBAAa,EAHD;AAIZ,mBAAS;AAJG,SAAd;AAMA,eAAO,IAAP,CAAY,WAAZ;AACD,OAxBD,MA0BA;AACE,YAAI,gBAAgB,QAAQ,MAAxB,IAAkC,YAAY,MAAZ,GAAqB,QAAQ,MAAR,CAAe,YAA1E,EACA;AACE,sBAAY,IAAZ,CAAiB,KAAjB;AACA;AACD;;AAED,YAAI,YAAJ,EACE,OAAO,aAAa,OAAb,EAAsB,KAAtB,CAAP,CADF,KAGE,MAAM,IAAI,WAAJ,CAAgB,sBAAsB,KAAtC,CAAN;AACH;AACF;AACF;;AAED,MAAI,OAAJ,EACA;AACE,QAAI,eAAe,aAAnB,EACE,OAAO,EAAP;;AAEF,WAAO,aAAa,OAAb,EAAsB,iBAAtB,CAAP;AACD,GAND,MAQA;AACE,QAAI,CAAC,YAAL,EACE,YAAY,WAAZ,GAA0B,WAA1B,CADF,KAGE,YAAY,IAAZ,GAAmB,WAAnB;;AAEF,QAAI,QAAQ,MAAR,IAAkB,YAAY,IAAZ,CAAiB,MAAjB,GAA0B,QAAQ,MAAR,CAAe,YAA/D,EACE,MAAM,IAAI,WAAJ,CAAgB,8CAA8C,QAAQ,IAAtD,GAA6D,GAA7E,CAAN;AACH;;AAED,SAAO,MAAP;AACD;;AAED,SAAS,kBAAT,CAA4B,IAA5B,EAAiC;AAC/B,SAAO,UAAS,EAAT,EAAY;AACjB,QAAI,WAAW,OAAO,GAAtB;;AAEA,QAAI,KAAK,QAAL,MAAmB,IAAvB,EACE,MAAM,IAAI,WAAJ,CAAgB,aAAa,IAAb,GAAoB,8BAApC,CAAN;;AAEF,QAAI,OAAO,EAAP,IAAa,UAAjB,EACE,MAAM,IAAI,WAAJ,CAAgB,gBAAgB,IAAhB,GAAuB,+BAAvC,CAAN;;AAEF,SAAK,QAAL,IAAiB,EAAjB;;AAEA,WAAO,IAAP;AACD,GAZD;AAaD;;AAED;;;AAGA,IAAI,UAAU,SAAV,OAAU,CAAS,IAAT,EAAe,MAAf,EAAsB;AAClC,OAAK,IAAL,GAAY,IAAZ;AACA,OAAK,MAAL,GAAc,KAAd;;AAEA,MAAI;AACF,QAAI,MAAJ,EACE,KAAK,MAAL,GAAc,YAAY,MAAZ,CAAd;AACH,GAHD,CAGE,OAAM,CAAN,EAAS;AACT,UAAM,IAAI,WAAJ,CAAgB,uDAAuD,KAAK,IAA5D,GAAmE,GAAnE,GAAyE,MAAzF,CAAN;AACD;;AAED,OAAK,QAAL,GAAgB,EAAhB;;AAEA,OAAK,OAAL,GAAe,EAAf;AACA,OAAK,KAAL,GAAa,EAAb;AACA,OAAK,IAAL,GAAY,EAAZ;AACA,OAAK,MAAL,GAAc,EAAd;AACA,OAAK,SAAL,GAAiB,EAAjB;;AAEA,OAAK,WAAL,GAAmB,EAAnB;;AAEA,OAAK,MAAL,CAAY,YAAZ,EAA0B,0BAA1B,EAAsD,YAAU;AAC9D,SAAK,QAAL;AACA,YAAQ,IAAR,CAAa,CAAb;AACD,GAHD,EAGG,SAHH;AAID,CAzBD;;AA2BA,QAAQ,SAAR,GAAoB;AAClB,UAAQ,IADU;AAElB,YAAU,IAFQ;AAGlB,WAAS,IAHS;AAIlB,SAAO,IAJW;AAKlB,QAAM,IALY;AAMlB,UAAQ,IANU;AAOlB,aAAW,IAPO;AAQlB,eAAa,IARK;;AAUlB,gBAAc,EAVI;AAWlB,YAAU,EAXQ;AAYlB,gBAAc,IAZI;AAalB,SAAO,IAbW;AAclB,aAAW,IAdO;AAelB,WAAS,IAfS;AAgBlB,SAAO,IAhBW;AAiBlB,QAAM,IAjBY;;AAmBlB,UAAQ,gBAAS,KAAT,EAAgB,WAAhB,EAA6B,KAA7B,EAAoC,KAApC,EAA0C;AAChD,uBAAmB,IAAnB,EAAyB,aAAa,KAAb,CAAmB,IAAnB,EAAyB,SAAzB,CAAzB;;AAEA,WAAO,IAAP;AACD,GAvBiB;AAwBlB,YAAU,kBAAS,KAAT,EAAgB,WAAhB,EAA6B,EAA7B,EAAiC,KAAjC,EAAwC,KAAxC,EAA8C;AACtD,QAAI,OAAO,EAAP,IAAa,UAAjB,EACE,MAAM,IAAI,WAAJ,CAAgB,yBAAhB,CAAN;;AAEF,QAAI,UAAU,IAAd;AACA,QAAI,SAAS,mBAAmB,IAAnB,EAAyB,aAAa,KAAb,EAAoB,WAApB,EAAiC,KAAjC,EAAwC,KAAxC,CAAzB,CAAb;AACA,QAAI,YAAY,OAAO,SAAvB;;AAEA,WAAO,SAAP,GAAmB,UAAS,KAAT,EAAe;AAChC,UAAI,MAAJ;;AAEA,cAAQ,UAAU,IAAV,CAAe,OAAf,EAAwB,KAAxB,CAAR;AACA,eAAS,GAAG,KAAH,CAAT;;AAEA,WAAK,IAAI,IAAT,IAAiB,MAAjB;AACE,YAAI,eAAe,IAAf,CAAoB,MAApB,EAA4B,IAA5B,CAAJ,EACE,IAAI,eAAe,IAAf,CAAoB,QAAQ,OAA5B,EAAqC,IAArC,CAAJ,EACE,QAAQ,SAAR,CAAkB,IAAlB,EAAwB,OAAO,IAAP,CAAxB,EADF,KAGE,QAAQ,MAAR,CAAe,IAAf,IAAuB,OAAO,IAAP,CAAvB;AALN,OAOA,QAAQ,MAAR,CAAe,OAAO,IAAtB,IAA8B,KAA9B;;AAEA,aAAO,KAAP;AACD,KAhBD;;AAkBA,WAAO,IAAP;AACD,GAnDiB;AAoDlB,aAAW,mBAAS,IAAT,EAAc;AACvB,WAAO,eAAe,IAAf,CAAoB,KAAK,OAAzB,EAAkC,IAAlC,CAAP;AACD,GAtDiB;AAuDlB,cAAY,sBAAU;AACpB,WAAO,oBAAY,KAAK,OAAjB,EAA0B,MAA1B,GAAmC,CAA1C;AACD,GAzDiB;AA0DlB,aAAW,mBAAS,IAAT,EAAe,KAAf,EAAsB,SAAtB,EAAgC;AACzC,QAAI,CAAC,KAAK,SAAL,CAAe,IAAf,CAAL,EACE,MAAM,IAAI,WAAJ,CAAgB,aAAa,IAAb,GAAoB,kBAApC,CAAN;;AAEF,QAAI,SAAS,KAAK,OAAL,CAAa,IAAb,CAAb;AACA,QAAI,WAAW,MAAM,OAAN,CAAc,KAAd,IACP,OAAO,SAAP,CAAiB,KAAjB,CAAuB,IAAvB,EAA6B,KAA7B,CADO,GAEP,OAAO,SAAP,CAAiB,IAAjB,CAAsB,IAAtB,EAA4B,KAA5B,CAFR;;AAIA,SAAK,MAAL,CAAY,IAAZ,IAAoB,OAAO,YAAP,GAAsB,QAAtB,GAAiC,KAArD;;AAEA,QAAI,aAAa,CAAC,eAAe,IAAf,CAAoB,KAAK,SAAzB,EAAoC,IAApC,CAAlB,EACE,KAAK,SAAL,CAAe,IAAf,IAAuB,KAAK,MAAL,CAAY,IAAZ,CAAvB;AACH,GAvEiB;AAwElB,cAAY,oBAAS,MAAT,EAAgB;AAC1B,SAAK,IAAI,IAAT,IAAiB,MAAjB;AACE,UAAI,eAAe,IAAf,CAAoB,MAApB,EAA4B,IAA5B,KAAqC,KAAK,SAAL,CAAe,IAAf,CAAzC,EACE,KAAK,SAAL,CAAe,IAAf,EAAqB,OAAO,IAAP,CAArB;AAFJ;AAGD,GA5EiB;AA6ElB,SAAO,iBAAU;AACf,SAAK,MAAL,GAAc,EAAd;;AAEA,WAAO,KAAK,MAAZ,EAAoB,KAAK,SAAzB;AACD,GAjFiB;;AAmFlB,WAAS,iBAAS,aAAT,EAAwB,MAAxB,EAA+B;AACtC,QAAI,IAAJ;AACA,QAAI,OAAJ;;AAEA,QAAI,yBAAyB,OAA7B,EACA;AACE,gBAAU,aAAV;AACA,aAAO,QAAQ,IAAf;AACD,KAJD,MAMA;AACE,aAAO,aAAP;;AAEA,UAAI,CAAC,6BAA6B,IAA7B,CAAkC,IAAlC,CAAL,EACE,MAAM,IAAI,WAAJ,CAAgB,yBAAyB,IAAzC,CAAN;AACH;;AAED;AACA,QAAI,aAAa,KAAK,QAAL,CAAc,IAAd,CAAjB;;AAEA,QAAI,CAAC,UAAL,EACA;AACE;AACA,mBAAa,WAAW,IAAI,OAAJ,CAAY,IAAZ,EAAkB,MAAlB,CAAxB;AACA,iBAAW,IAAX,GAAkB,IAAlB;AACA,WAAK,QAAL,CAAc,IAAd,IAAsB,UAAtB;AACA,WAAK,WAAL,CAAiB,IAAjB,CAAsB,IAAtB;AACD;;AAED,WAAO,UAAP;AACD,GAjHiB;AAkHlB,OAAK,eAAW;AACd,WAAO,KAAK,IAAZ;AACD,GApHiB;AAqHlB,eAAa,uBAAU;AACrB,WAAO,oBAAY,KAAK,QAAjB,EAA2B,MAA3B,GAAoC,CAA3C;AACD,GAvHiB;;AAyHlB,WAAS,iBAAS,QAAT,EAAkB,KAAlB,EAAyB,WAAzB,EAAqC;AAC5C,QAAI,KAAK,QAAT,EACE,MAAM,IAAI,WAAJ,CAAgB,4CAAhB,CAAN;;AAEF,SAAK,QAAL,GAAgB,QAAhB;AACA,SAAK,MAAL,CACE,SAAS,eADX,EAEE,eAAe,gBAFjB,EAGE,YAAU;AACR,cAAQ,GAAR,CAAY,KAAK,QAAjB;AACA,cAAQ,IAAR,CAAa,CAAb;AACD,KANH,EAOE,SAPF;;AAUA,WAAO,IAAP;AACD,GAzIiB;AA0IlB,eAAa,qBAAS,YAAT,EAAqB;AAChC,QAAI,KAAK,YAAT,EACE,MAAM,IAAI,WAAJ,CAAgB,gDAAhB,CAAN;;AAEF,SAAK,YAAL,GAAoB,YAApB;;AAEA,WAAO,IAAP;AACD,GAjJiB;;AAmJlB,QAAM,mBAAmB,MAAnB,CAnJY;AAoJlB,eAAa,mBAAmB,aAAnB,CApJK;AAqJlB,QAAM,mBAAmB,MAAnB,CArJY;AAsJlB,YAAU,mBAAmB,UAAnB,CAtJQ;AAuJlB,UAAQ,mBAAmB,QAAnB,CAvJU;;AAyJlB,UAAQ,gBAAS,EAAT,EAAY;AAClB,OAAG,KAAH,CAAS,IAAT,EAAe,CAAC,IAAD,EAAO,MAAP,CAAc,MAAM,SAAN,CAAgB,KAAhB,CAAsB,IAAtB,CAA2B,SAA3B,EAAsC,CAAtC,CAAd,CAAf;AACA,WAAO,IAAP;AACD,GA5JiB;;AA8JlB,SAAO,eAAS,IAAT,EAAe,OAAf,EAAuB;AAC5B,QAAI,CAAC,IAAL,EACE,OAAO,QAAQ,IAAR,CAAa,KAAb,CAAmB,CAAnB,CAAP;;AAEF,QAAI,CAAC,YAAL,EACE,OAAO,YAAY,IAAZ,EAAkB,IAAlB,EAAwB,OAAxB,CAAP,CADF,KAGE,IAAI;AACF,aAAO,YAAY,IAAZ,EAAkB,IAAlB,EAAwB,OAAxB,CAAP;AACD,KAFD,CAEE,OAAM,CAAN,EAAS;AACT,mBAAa,EAAE,OAAF,IAAa,CAA1B;AACD;AACJ,GA1KiB;AA2KlB,OAAK,aAAS,IAAT,EAAe,OAAf,EAAuB;AAC1B,QAAI,WAAW,KAAK,KAAL,CAAW,IAAX,CAAf;;AAEA,QAAI,CAAC,QAAL,EACE;;AAEF,QAAI,WAAJ;AACA,QAAI,UAAU,OAAO,EAAP,EAAW,WAAW,KAAK,YAAL,EAAtB,CAAd;AACA,SAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,SAAS,MAA7B,EAAqC,GAArC,EACA;AACE,UAAI,OAAO,SAAS,CAAT,CAAX;AACA,UAAI,UAAU,KAAK,OAAnB;;AAEA;AACA,cAAQ,KAAR;AACA,cAAQ,OAAR,GAAkB,OAAlB;AACA,cAAQ,IAAR,GAAe,IAAf;;AAEA,UAAI,WAAJ,EACE,YAAY,SAAZ,CAAsB,OAAtB;;AAEF;AACA,cAAQ,UAAR,CACE,KAAK,OAAL,CAAa,MAAb,CAAoB,UAAS,GAAT,EAAc,KAAd,EAAoB;AACtC,YAAI,MAAM,MAAN,CAAa,UAAjB,EACE,IAAI,MAAM,MAAN,CAAa,SAAjB,IAA8B,MAAM,KAApC;AACF,eAAO,GAAP;AACD,OAJD,EAIG,EAJH,CADF;;AAQA,cAAQ,KAAR,CAAc,KAAK,IAAnB;;AAEA,UAAI,KAAK,IAAL,CAAU,MAAd,EACE,QAAQ,KAAR,CAAc,KAAK,IAAnB;;AAEF;AACA,cAAQ,UAAR,CACE,KAAK,OAAL,CAAa,MAAb,CAAoB,UAAS,GAAT,EAAc,KAAd,EAAoB;AACtC,YAAI,CAAC,MAAM,MAAN,CAAa,UAAlB,EACE,IAAI,MAAM,MAAN,CAAa,SAAjB,IAA8B,MAAM,KAApC;AACF,eAAO,GAAP;AACD,OAJD,EAIG,EAJH,CADF;;AAQA,oBAAc,OAAd;AACD;;AAED;AACA,QAAI,OAAJ,EACE,OAAO,QAAQ,OAAR,CAAgB,KAAK,IAArB,EAA2B,KAAK,WAAhC,CAAP;AACH,GA7NiB;;AA+NlB,aAAW,mBAAS,MAAT,EAAgB;AACzB,QAAI,SAAS,EAAb;;AAEA,QAAI,CAAC,MAAL,EACE,SAAS,EAAT;;AAEF,SAAK,IAAI,IAAT,IAAiB,KAAK,MAAtB;AACE,UAAI,eAAe,IAAf,CAAoB,KAAK,MAAzB,EAAiC,IAAjC,CAAJ,EACE,OAAO,IAAP,IAAe,eAAe,IAAf,CAAoB,MAApB,EAA4B,IAA5B,KAAqC,eAAe,IAAf,CAAoB,KAAK,OAAzB,EAAkC,IAAlC,CAArC,GACX,KAAK,OAAL,CAAa,IAAb,EAAmB,SAAnB,CAA6B,IAA7B,CAAkC,IAAlC,EAAwC,OAAO,IAAP,CAAxC,CADW,GAEX,KAAK,MAAL,CAAY,IAAZ,CAFJ;AAFJ,KAMA,KAAK,IAAI,IAAT,IAAiB,MAAjB;AACE,UAAI,eAAe,IAAf,CAAoB,MAApB,EAA4B,IAA5B,KAAqC,CAAC,eAAe,IAAf,CAAoB,KAAK,OAAzB,EAAkC,IAAlC,CAA1C,EACE,OAAO,IAAP,IAAe,OAAO,IAAP,CAAf;AAFJ,KAIA,OAAO,MAAP;AACD,GAhPiB;;AAkPlB,YAAU,oBAAU;AAClB,YAAQ,GAAR,CAAY,gBAAgB,IAAhB,CAAZ;AACD;AApPiB,CAApB;;AAwPA;AACA;AACA;;AAEA;;;;;;;AAOA,SAAS,eAAT,CAAyB,OAAzB,EAAiC;AAC/B,WAAS,YAAT,CAAsB,GAAtB,EAA2B,MAA3B,EAAkC;AAChC,QAAI,QAAQ,IAAI,KAAJ,CAAU,GAAV,CAAZ;AACA,QAAI,WAAW,iBAAiB,MAAjB,IAA2B,CAA1C;AACA,QAAI,QAAQ,EAAZ;AACA,QAAI,OAAO,EAAX;;AAEA,WAAO,MAAM,MAAb,EACA;AACE,UAAI,OAAO,MAAM,KAAN,EAAX;AACA,UAAI,CAAC,IAAD,IAAU,KAAK,MAAL,GAAc,KAAK,MAAnB,GAA4B,CAA7B,GAAkC,QAA/C,EACA;AACE,gBAAQ,CAAC,OAAO,GAAP,GAAa,EAAd,IAAoB,IAA5B;AACD,OAHD,MAKA;AACE,cAAM,IAAN,CAAW,IAAX;AACA,cAAM,OAAN,CAAc,IAAd;AACA,eAAO,EAAP;AACD;AACF;;AAED,UAAM,IAAN,CAAW,IAAX;;AAEA,WAAO,MAAM,GAAN,CAAU,UAAS,IAAT,EAAe,GAAf,EAAmB;AAClC,aAAO,CAAC,OAAO,MAAP,GAAgB,IAAI,MAAJ,EAAY,EAAZ,CAAhB,GAAkC,EAAnC,IAAyC,IAAhD;AACD,KAFM,EAEJ,IAFI,CAEC,IAFD,CAAP;AAGD;;AAED,WAAS,IAAT,CAAc,OAAd,EAAsB;AACpB,WAAO,QAAQ,MAAR,CAAe,IAAf,CAAoB,GAApB,CAAwB,UAAS,GAAT,EAAa;AACxC,aAAO,IAAI,QAAJ,GACH,MAAM,IAAI,IAAV,GAAiB,GADd,GAEH,MAAM,IAAI,IAAV,GAAiB,GAFrB;AAGD,KAJI,EAIF,IAJE,CAIG,GAJH,CAAP;AAKD;;AAED,WAAS,YAAT,GAAuB;AACrB,QAAI,CAAC,QAAQ,WAAR,EAAL,EACE,OAAO,EAAP;;AAEF,QAAI,gBAAgB,aAAa,CAAjC;AACA,QAAI,QAAQ,oBAAY,QAAQ,QAApB,EAA8B,IAA9B,GAAqC,GAArC,CAAyC,UAAS,IAAT,EAAc;AACjE,UAAI,aAAa,QAAQ,QAAR,CAAiB,IAAjB,CAAjB;;AAEA,UAAI,OAAO;AACT,cAAM,MAAM,KAAN,CAAY,IAAZ,IAAoB,MAAM,IAAN,CACvB,WAAW,MAAX,GAAoB,MAAM,KAAK,UAAL,CAA1B,GAA6C,EADtB,CADjB;AAKT,qBAAa,WAAW,YAAX,IAA2B;AAL/B,OAAX;;AAQA,sBAAgB,KAAK,GAAL,CAAS,aAAT,EAAwB,aAAa,KAAK,IAAlB,CAAxB,CAAhB;;AAEA,aAAO,IAAP;AACD,KAdW,CAAZ;;AAgBA,WAAO,CACL,EADK,EAEL,WAFK,EAGL,EAHK,EAIL,MAAM,GAAN,CAAU,UAAS,IAAT,EAAc;AACtB,aAAO,OAAO,IAAI,aAAJ,EAAmB,KAAK,IAAxB,CAAP,GAAuC,IAAvC,GAA8C,aAAa,KAAK,WAAlB,EAA+B,gBAAgB,CAA/C,CAArD;AACD,KAFD,EAEG,IAFH,CAEQ,IAFR,CAJK,EAOL,EAPK,EAQL,IARK,CAQA,IARA,CAAP;AASD;;AAED,WAAS,WAAT,GAAsB;AACpB,QAAI,CAAC,QAAQ,UAAR,EAAL,EACE,OAAO,EAAP;;AAEF,QAAI,kBAAkB,oBAAY,QAAQ,KAApB,EAA2B,MAA3B,GAAoC,CAA1D;AACA,QAAI,gBAAgB,aAAa,CAAjC;AACA,QAAI,QAAQ,oBAAY,QAAQ,IAApB,EAA0B,IAA1B,GAAiC,GAAjC,CAAqC,UAAS,IAAT,EAAc;AAC7D,UAAI,SAAS,QAAQ,IAAR,CAAa,IAAb,CAAb;AACA,UAAI,OAAO;AACT,cAAM,OAAO,KAAP,CACH,OADG,CACK,YADL,EACmB,UAAS,CAAT,EAAW;AAChC,iBAAO,MAAM,kBAAkB,MAAlB,GAA2B,EAAjC,CAAP;AACD,SAHG,EAIH,OAJG,CAIK,oBAJL,EAI2B,UAAS,CAAT,EAAY,CAAZ,EAAe,IAAf,EAAoB;AACjD,iBAAO,IAAI,MAAM,MAAN,CAAa,IAAb,CAAX;AACD,SANG,CADG;AAQT,qBAAa,OAAO;AARX,OAAX;;AAWA,sBAAgB,KAAK,GAAL,CAAS,aAAT,EAAwB,aAAa,KAAK,IAAlB,CAAxB,CAAhB;;AAEA,aAAO,IAAP;AACD,KAhBW,CAAZ;;AAkBA;AACA,WAAO,CACL,EADK,EAEL,UAFK,EAGL,EAHK,EAIL,MAAM,GAAN,CAAU,UAAS,IAAT,EAAc;AACtB,aAAO,OAAO,IAAI,aAAJ,EAAmB,KAAK,IAAxB,CAAP,GAAuC,IAAvC,GAA8C,aAAa,KAAK,WAAlB,EAA+B,gBAAgB,CAA/C,CAArD;AACD,KAFD,EAEG,IAFH,CAEQ,IAFR,CAJK,EAOL,EAPK,EAQL,IARK,CAQA,IARA,CAAP;AASD;;AAED,MAAI,SAAS,EAAb;AACA,MAAI,QAAQ,QAAQ,OAAR,CAAZ;;AAEA,QAAM,OAAN,GAAgB,OAAO,OAAP,CAAe,KAAf,IAAwB,QAAQ,MAAR,CAAe,KAAvD;;AAEA,MAAI,QAAQ,YAAZ,EACE,OAAO,IAAP,CAAY,QAAQ,YAAR,GAAuB,IAAnC;;AAEF,SAAO,IAAP,CACE,iBACE,MAAM,IAAN,CAAW,eAAe,aAAa,IAAb,CAAkB,GAAlB,CAAf,GAAwC,QAAQ,IAA3D,CADF,IAEG,QAAQ,MAAR,GAAiB,MAAM,MAAM,OAAN,CAAc,KAAK,OAAL,CAAd,CAAvB,GAAsD,EAFzD,KAGG,QAAQ,UAAR,KAAuB,OAAO,MAAM,MAAN,CAAa,SAAb,CAAP,GAAiC,GAAxD,GAA8D,EAHjE,KAIG,QAAQ,WAAR,KAAwB,OAAO,MAAM,KAAN,CAAY,SAAZ,CAAP,GAAgC,GAAxD,GAA8D,EAJjE,CADF,EAME,iBACA,aAPF;;AAUA,SAAO,OAAO,IAAP,CAAY,IAAZ,CAAP;AACD;;AAGD;AACA;AACA;;AAEA,OAAO,OAAP,GAAiB;AACf,SAAO,IADQ;;AAGf,SAAO,WAHQ;AAIf,YAAU,QAJK;AAKf,WAAS,OALM;AAMf,UAAQ,MANO;;AAQf,SAAO,eAAS,EAAT,EAAY;AACjB,QAAI,YAAJ,EACE,MAAM,IAAI,WAAJ,CAAgB,uCAAhB,CAAN;;AAEF,QAAI,OAAO,EAAP,IAAa,UAAjB,EACE,MAAM,IAAI,WAAJ,CAAgB,oCAAhB,CAAN;;AAEF,mBAAe,EAAf;;AAEA,WAAO,IAAP;AACD,GAlBc;;AAoBf,UAAQ,gBAAS,IAAT,EAAe,MAAf,EAAsB;AAC5B,WAAO,IAAI,OAAJ,CAAY,QAAQ,QAAQ,MAAR,EAAgB,QAAhB,CAAyB,QAAQ,IAAR,CAAa,CAAb,CAAzB,CAAR,IAAqD,KAAjE,EAAwE,MAAxE,CAAP;AACD,GAtBc;;AAwBf,WAAS,iBAAS,OAAT,EAAkB,EAAlB,EAAqB;AAC5B,YAAQ,MAAR,CAAe,KAAf,CAAqB,OAArB;AACA,YAAQ,KAAR,CAAc,WAAd,CAA0B,MAA1B;AACA,YAAQ,KAAR,CAAc,IAAd,CAAmB,MAAnB,EAA2B,UAAS,GAAT,EAAa;AACtC,cAAQ,KAAR,CAAc,KAAd;AACA,SAAG,mBAAmB,IAAnB,CAAwB,IAAI,IAAJ,EAAxB,CAAH;AACD,KAHD;AAIA,YAAQ,KAAR,CAAc,MAAd;AACD;AAhCc,CAAjB","file":"index-compiled.js","sourcesContent":["var MAX_LINE_WIDTH = process.stdout.columns || 200;\nvar MIN_OFFSET = 25;\n\nvar errorHandler;\nvar commandsPath;\n\nvar reAstral = /[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g;\nvar ansiRegex = /\\x1B\\[([0-9]{1,3}(;[0-9]{1,3})*)?[m|K]/g;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction stringLength(str){\n  return str\n    .replace(ansiRegex, '')\n    .replace(reAstral, ' ')\n    .length;\n}\n\nfunction camelize(name){\n  return name.replace(/-(.)/g, function(m, ch){\n    return ch.toUpperCase();\n  });\n}\n\nfunction assign(dest, source){\n  for (var key in source)\n    if (hasOwnProperty.call(source, key))\n      dest[key] = source[key];\n\n  return dest;\n}\n\nfunction returnFirstArg(value){\n  return value;\n}\n\nfunction pad(width, str){\n  return str + Array(Math.max(0, width - stringLength(str)) + 1).join(' ');\n}\n\nfunction noop(){\n  // nothing todo\n}\n\nfunction parseParams(str){\n  // params [..<required>] [..[optional]]\n  // <foo> - require\n  // [foo] - optional\n  var tmp;\n  var left = str.trim();\n  var result = {\n    minArgsCount: 0,\n    maxArgsCount: 0,\n    args: []\n  };\n\n  do {\n    tmp = left;\n    left = left.replace(/^<([a-zA-Z][a-zA-Z0-9\\-\\_]*)>\\s*/, function(m, name){\n      result.args.push(new Argument(name, true));\n      result.minArgsCount++;\n      result.maxArgsCount++;\n\n      return '';\n    });\n  }\n  while (tmp != left);\n\n  do {\n    tmp = left;\n    left = left.replace(/^\\[([a-zA-Z][a-zA-Z0-9\\-\\_]*)\\]\\s*/, function(m, name){\n      result.args.push(new Argument(name, false));\n      result.maxArgsCount++;\n\n      return '';\n    });\n  }\n  while (tmp != left);\n\n  if (left)\n    throw new SyntaxError('Bad parameter description: ' + str);\n\n  return result.args.length ? result : false;\n}\n\n/**\n* @class\n*/\n\nvar SyntaxError = function(message){\n  this.message = message;\n};\nSyntaxError.prototype = Object.create(Error.prototype);\nSyntaxError.prototype.name = 'SyntaxError';\nSyntaxError.prototype.clap = true;\n\n/**\n* @class\n*/\nvar Argument = function(name, required){\n  this.name = name;\n  this.required = required;\n};\nArgument.prototype = {\n  required: false,\n  name: '',\n  normalize: returnFirstArg,\n  suggest: function(){\n    return [];\n  }\n};\n\n/**\n* @class\n* @param {string} usage\n* @param {string} description\n*/\nvar Option = function(usage, description){\n  var self = this;\n  var params;\n  var left = usage.trim()\n    // short usage\n    // -x\n    .replace(/^-([a-zA-Z])(?:\\s*,\\s*|\\s+)/, function(m, name){\n      self.short = name;\n\n      return '';\n    })\n    // long usage\n    // --flag\n    // --no-flag - invert value if flag is boolean\n    .replace(/^--([a-zA-Z][a-zA-Z0-9\\-\\_]+)\\s*/, function(m, name){\n      self.long = name;\n      self.name = name.replace(/(^|-)no-/, '$1');\n      self.defValue = self.name != self.long;\n\n      return '';\n    });\n\n  if (!this.long)\n    throw new SyntaxError('Usage has no long name: ' + usage);\n\n  try {\n    params = parseParams(left);\n  } catch(e) {\n    throw new SyntaxError('Bad paramenter description in usage for option: ' + usage, e);\n  }\n\n  if (params)\n  {\n    left = '';\n    this.name = this.long;\n    this.defValue = undefined;\n\n    assign(this, params);\n  }\n\n  if (left)\n    throw new SyntaxError('Bad usage description for option: ' + usage);\n\n  if (!this.name)\n    this.name = this.long;\n\n  this.description = description || '';\n  this.usage = usage.trim();\n  this.camelName = camelize(this.name);\n};\n\nOption.prototype = {\n  name: '',\n  description: '',\n  short: '',\n  long: '',\n\n  beforeInit: false,\n  required: false,\n  minArgsCount: 0,\n  maxArgsCount: 0,\n  args: null,\n\n  defValue: undefined,\n  normalize: returnFirstArg\n};\n\n\n//\n// Command\n//\n\nfunction createOption(usage, description, opt_1, opt_2){\n  var option = new Option(usage, description);\n\n  // if (option.bool && arguments.length > 2)\n  //   throw new SyntaxError('bool flags can\\'t has default value or validator');\n\n  if (arguments.length == 3)\n  {\n    if (opt_1 && opt_1.constructor === Object)\n    {\n      for (var key in opt_1)\n        if (key == 'normalize' ||\n            key == 'defValue' ||\n            key == 'beforeInit')\n          option[key] = opt_1[key];\n\n      // old name for `beforeInit` setting is `hot`\n      if (opt_1.hot)\n        option.beforeInit = true;\n    }\n    else\n    {\n      if (typeof opt_1 == 'function')\n        option.normalize = opt_1;\n      else\n        option.defValue = opt_1;\n    }\n  }\n\n  if (arguments.length == 4)\n  {\n    if (typeof opt_1 == 'function')\n      option.normalize = opt_1;\n\n    option.defValue = opt_2;\n  }\n\n  return option;\n}\n\nfunction addOptionToCommand(command, option){\n  var commandOption;\n\n  // short\n  if (option.short)\n  {\n    commandOption = command.short[option.short];\n\n    if (commandOption)\n      throw new SyntaxError('Short option name -' + option.short + ' already in use by ' + commandOption.usage + ' ' + commandOption.description);\n\n    command.short[option.short] = option;\n  }\n\n  // long\n  commandOption = command.long[option.long];\n\n  if (commandOption)\n    throw new SyntaxError('Long option --' + option.long + ' already in use by ' + commandOption.usage + ' ' + commandOption.description);\n\n  command.long[option.long] = option;\n\n  // camel\n  commandOption = command.options[option.camelName];\n\n  if (commandOption)\n    throw new SyntaxError('Name option ' + option.camelName + ' already in use by ' + commandOption.usage + ' ' + commandOption.description);\n\n  command.options[option.camelName] = option;\n\n  // set default value\n  if (typeof option.defValue != 'undefined')\n    command.setOption(option.camelName, option.defValue, true);\n\n  // add to suggestions\n  command.suggestions.push('--' + option.long);\n\n  return option;\n}\n\nfunction findVariants(obj, entry){\n  return obj.suggestions.filter(function(item){\n    return item.substr(0, entry.length) == entry;\n  });\n}\n\nfunction processArgs(command, args, suggest){\n  function processOption(option, command){\n    var params = [];\n\n    if (option.maxArgsCount)\n    {\n      for (var j = 0; j < option.maxArgsCount; j++)\n      {\n        var suggestPoint = suggest && i + 1 + j >= args.length - 1;\n        var nextToken = args[i + 1];\n\n        // TODO: suggestions for options\n        if (suggestPoint)\n        {\n          // search for suggest\n          noSuggestions = true;\n          i = args.length;\n          return;\n        }\n\n        if (!nextToken || nextToken[0] == '-')\n          break;\n\n        params.push(args[++i]);\n      }\n\n      if (params.length < option.minArgsCount)\n        throw new SyntaxError('Option ' + token + ' should be used with at least ' + option.minArgsCount + ' argument(s)\\nUsage: ' + option.usage);\n    }\n    else\n    {\n      params = !option.defValue;\n    }\n\n    //command.values[option.camelName] = newValue;\n    resultToken.options.push({\n      option: option,\n      value: params\n    });\n  }\n\n  var resultToken = {\n    command: command,\n    args: [],\n    literalArgs: [],\n    options: []\n  };\n  var result = [resultToken];\n\n  var suggestStartsWith = '';\n  var noSuggestions = false;\n  var collectArgs = false;\n  var commandArgs = [];\n  var noOptionsYet = true;\n  var option;\n\n  commandsPath = [command.name];\n\n  for (var i = 0; i < args.length; i++)\n  {\n    var suggestPoint = suggest && i == args.length - 1;\n    var token = args[i];\n\n    if (collectArgs)\n    {\n      commandArgs.push(token);\n      continue;\n    }\n\n    if (suggestPoint && (token == '--' || token == '-' || token[0] != '-'))\n    {\n      suggestStartsWith = token;\n      break; // returns long option & command list outside the loop\n    }\n\n    if (token == '--')\n    {\n      noOptionsYet = false;\n      collectArgs = true;\n      continue;\n    }\n\n    if (token[0] == '-')\n    {\n      noOptionsYet = false;\n\n      if (commandArgs.length)\n      {\n        //command.args_.apply(command, commandArgs);\n        resultToken.args = commandArgs;\n        commandArgs = [];\n      }\n\n      if (token[1] == '-')\n      {\n        // long option\n        option = command.long[token.substr(2)];\n\n        if (!option)\n        {\n          // option doesn't exist\n          if (suggestPoint)\n            return findVariants(command, token);\n          else\n            throw new SyntaxError('Unknown option: ' + token);\n        }\n\n        // process option\n        processOption(option, command);\n      }\n      else\n      {\n        // short flags sequence\n        if (!/^-[a-zA-Z]+$/.test(token))\n          throw new SyntaxError('Wrong short option sequence: ' + token);\n\n        if (token.length == 2)\n        {\n          option = command.short[token[1]];\n\n          if (!option)\n            throw new SyntaxError('Unknown short option name: -' + token[1]);\n\n          // single option\n          processOption(option, command);\n        }\n        else\n        {\n          // short options sequence\n          for (var j = 1; j < token.length; j++)\n          {\n            option = command.short[token[j]];\n\n            if (!option)\n              throw new SyntaxError('Unknown short option name: -' + token[j]);\n\n            if (option.maxArgsCount)\n              throw new SyntaxError('Non-boolean option -' + token[j] + ' can\\'t be used in short option sequence: ' + token);\n\n            processOption(option, command);\n          }\n        }\n      }\n    }\n    else\n    {\n      if (command.commands[token] && (!command.params || commandArgs.length >= command.params.minArgsCount))\n      {\n        if (noOptionsYet)\n        {\n          resultToken.args = commandArgs;\n          commandArgs = [];\n        }\n\n        if (command.params && resultToken.args.length < command.params.minArgsCount)\n          throw new SyntaxError('Missed required argument(s) for command `' + command.name + '`');\n\n        // switch control to another command\n        command = command.commands[token];\n        noOptionsYet = true;\n\n        commandsPath.push(command.name);\n\n        resultToken = {\n          command: command,\n          args: [],\n          literalArgs: [],\n          options: []\n        };\n        result.push(resultToken);\n      }\n      else\n      {\n        if (noOptionsYet && command.params && commandArgs.length < command.params.maxArgsCount)\n        {\n          commandArgs.push(token);\n          continue;\n        }\n\n        if (suggestPoint)\n          return findVariants(command, token);\n        else\n          throw new SyntaxError('Unknown command: ' + token);\n      }\n    }\n  }\n\n  if (suggest)\n  {\n    if (collectArgs || noSuggestions)\n      return [];\n\n    return findVariants(command, suggestStartsWith);\n  }\n  else\n  {\n    if (!noOptionsYet)\n      resultToken.literalArgs = commandArgs;\n    else\n      resultToken.args = commandArgs;\n\n    if (command.params && resultToken.args.length < command.params.minArgsCount)\n      throw new SyntaxError('Missed required argument(s) for command `' + command.name + '`');\n  }\n\n  return result;\n}\n\nfunction setFunctionFactory(name){\n  return function(fn){\n    var property = name + '_';\n\n    if (this[property] !== noop)\n      throw new SyntaxError('Method `' + name + '` could be invoked only once');\n\n    if (typeof fn != 'function')\n      throw new SyntaxError('Value for `' + name + '` method should be a function');\n\n    this[property] = fn;\n\n    return this;\n  }\n}\n\n/**\n* @class\n*/\nvar Command = function(name, params){\n  this.name = name;\n  this.params = false;\n\n  try {\n    if (params)\n      this.params = parseParams(params);\n  } catch(e) {\n    throw new SyntaxError('Bad paramenter description in command definition: ' + this.name + ' ' + params);\n  }\n\n  this.commands = {};\n\n  this.options = {};\n  this.short = {};\n  this.long = {};\n  this.values = {};\n  this.defaults_ = {};\n\n  this.suggestions = [];\n\n  this.option('-h, --help', 'Output usage information', function(){\n    this.showHelp();\n    process.exit(0);\n  }, undefined);\n};\n\nCommand.prototype = {\n  params: null,\n  commands: null,\n  options: null,\n  short: null,\n  long: null,\n  values: null,\n  defaults_: null,\n  suggestions: null,\n\n  description_: '',\n  version_: '',\n  initContext_: noop,\n  init_: noop,\n  delegate_: noop,\n  action_: noop,\n  args_: noop,\n  end_: null,\n\n  option: function(usage, description, opt_1, opt_2){\n    addOptionToCommand(this, createOption.apply(null, arguments));\n\n    return this;\n  },\n  shortcut: function(usage, description, fn, opt_1, opt_2){\n    if (typeof fn != 'function')\n      throw new SyntaxError('fn should be a function');\n\n    var command = this;\n    var option = addOptionToCommand(this, createOption(usage, description, opt_1, opt_2));\n    var normalize = option.normalize;\n\n    option.normalize = function(value){\n      var values;\n\n      value = normalize.call(command, value);\n      values = fn(value);\n\n      for (var name in values)\n        if (hasOwnProperty.call(values, name))\n          if (hasOwnProperty.call(command.options, name))\n            command.setOption(name, values[name]);\n          else\n            command.values[name] = values[name];\n\n      command.values[option.name] = value;\n\n      return value;\n    };\n\n    return this;\n  },\n  hasOption: function(name){\n    return hasOwnProperty.call(this.options, name);\n  },\n  hasOptions: function(){\n    return Object.keys(this.options).length > 0;\n  },\n  setOption: function(name, value, isDefault){\n    if (!this.hasOption(name))\n      throw new SyntaxError('Option `' + name + '` is not defined');\n\n    var option = this.options[name];\n    var newValue = Array.isArray(value)\n          ? option.normalize.apply(this, value)\n          : option.normalize.call(this, value);\n\n    this.values[name] = option.maxArgsCount ? newValue : value;\n\n    if (isDefault && !hasOwnProperty.call(this.defaults_, name))\n      this.defaults_[name] = this.values[name];\n  },\n  setOptions: function(values){\n    for (var name in values)\n      if (hasOwnProperty.call(values, name) && this.hasOption(name))\n        this.setOption(name, values[name]);\n  },\n  reset: function(){\n    this.values = {};\n\n    assign(this.values, this.defaults_);\n  },\n\n  command: function(nameOrCommand, params){\n    var name;\n    var command;\n\n    if (nameOrCommand instanceof Command)\n    {\n      command = nameOrCommand;\n      name = command.name;\n    }\n    else\n    {\n      name = nameOrCommand;\n\n      if (!/^[a-zA-Z][a-zA-Z0-9\\-\\_]*$/.test(name))\n        throw new SyntaxError('Wrong command name: ' + name);\n    }\n\n    // search for existing one\n    var subcommand = this.commands[name];\n\n    if (!subcommand)\n    {\n      // create new one if not exists\n      subcommand = command || new Command(name, params);\n      subcommand.end_ = this;\n      this.commands[name] = subcommand;\n      this.suggestions.push(name);\n    }\n\n    return subcommand;\n  },\n  end: function() {\n    return this.end_;\n  },\n  hasCommands: function(){\n    return Object.keys(this.commands).length > 0;\n  },\n\n  version: function(version, usage, description){\n    if (this.version_)\n      throw new SyntaxError('Version for command could be set only once');\n\n    this.version_ = version;\n    this.option(\n      usage || '-v, --version',\n      description || 'Output version',\n      function(){\n        console.log(this.version_);\n        process.exit(0);\n      },\n      undefined\n    );\n\n    return this;\n  },\n  description: function(description){\n    if (this.description_)\n      throw new SyntaxError('Description for command could be set only once');\n\n    this.description_ = description;\n\n    return this;\n  },\n\n  init: setFunctionFactory('init'),\n  initContext: setFunctionFactory('initContext'),\n  args: setFunctionFactory('args'),\n  delegate: setFunctionFactory('delegate'),\n  action: setFunctionFactory('action'),\n\n  extend: function(fn){\n    fn.apply(null, [this].concat(Array.prototype.slice.call(arguments, 1)));\n    return this;\n  },\n\n  parse: function(args, suggest){\n    if (!args)\n      args = process.argv.slice(2);\n\n    if (!errorHandler)\n      return processArgs(this, args, suggest);\n    else\n      try {\n        return processArgs(this, args, suggest);\n      } catch(e) {\n        errorHandler(e.message || e);\n      }\n  },\n  run: function(args, context){\n    var commands = this.parse(args);\n\n    if (!commands)\n      return;\n\n    var prevCommand;\n    var context = assign({}, context || this.initContext_());\n    for (var i = 0; i < commands.length; i++)\n    {\n      var item = commands[i];\n      var command = item.command;\n\n      // reset command values\n      command.reset();\n      command.context = context;\n      command.root = this;\n\n      if (prevCommand)\n        prevCommand.delegate_(command);\n\n      // apply beforeInit options\n      command.setOptions(\n        item.options.reduce(function(res, entry){\n          if (entry.option.beforeInit)\n            res[entry.option.camelName] = entry.value;\n          return res;\n        }, {})\n      );\n\n      command.init_(item.args);\n\n      if (item.args.length)\n        command.args_(item.args);\n\n      // apply regular options\n      command.setOptions(\n        item.options.reduce(function(res, entry){\n          if (!entry.option.beforeInit)\n            res[entry.option.camelName] = entry.value;\n          return res;\n        }, {})\n      );\n\n      prevCommand = command;\n    }\n\n    // return last command action result\n    if (command)\n      return command.action_(item.args, item.literalArgs);\n  },\n\n  normalize: function(values){\n    var result = {};\n\n    if (!values)\n      values = {};\n\n    for (var name in this.values)\n      if (hasOwnProperty.call(this.values, name))\n        result[name] = hasOwnProperty.call(values, name) && hasOwnProperty.call(this.options, name)\n          ? this.options[name].normalize.call(this, values[name])\n          : this.values[name];\n\n    for (var name in values)\n      if (hasOwnProperty.call(values, name) && !hasOwnProperty.call(this.options, name))\n        result[name] = values[name];\n\n    return result;\n  },\n\n  showHelp: function(){\n    console.log(showCommandHelp(this));\n  }\n};\n\n\n//\n// help\n//\n\n/**\n * Return program help documentation.\n *\n * @return {String}\n * @api private\n */\n\nfunction showCommandHelp(command){\n  function breakByLines(str, offset){\n    var words = str.split(' ');\n    var maxWidth = MAX_LINE_WIDTH - offset || 0;\n    var lines = [];\n    var line = '';\n\n    while (words.length)\n    {\n      var word = words.shift();\n      if (!line || (line.length + word.length + 1) < maxWidth)\n      {\n        line += (line ? ' ' : '') + word;\n      }\n      else\n      {\n        lines.push(line);\n        words.unshift(word);\n        line = '';\n      }\n    }\n\n    lines.push(line);\n\n    return lines.map(function(line, idx){\n      return (idx && offset ? pad(offset, '') : '') + line;\n    }).join('\\n');\n  }\n\n  function args(command){\n    return command.params.args.map(function(arg){\n        return arg.required\n          ? '<' + arg.name + '>'\n          : '[' + arg.name + ']';\n      }).join(' ');\n  }\n\n  function commandsHelp(){\n    if (!command.hasCommands())\n      return '';\n\n    var maxNameLength = MIN_OFFSET - 2;\n    var lines = Object.keys(command.commands).sort().map(function(name){\n      var subcommand = command.commands[name];\n\n      var line = {\n        name: chalk.green(name) + chalk.gray(\n          (subcommand.params ? ' ' + args(subcommand) : '')\n          // (subcommand.hasOptions() ? ' [options]' : '')\n        ),\n        description: subcommand.description_ || ''\n      };\n\n      maxNameLength = Math.max(maxNameLength, stringLength(line.name));\n\n      return line;\n    });\n\n    return [\n      '',\n      'Commands:',\n      '',\n      lines.map(function(line){\n        return '  ' + pad(maxNameLength, line.name) + '  ' + breakByLines(line.description, maxNameLength + 4);\n      }).join('\\n'),\n      ''\n    ].join('\\n');\n  }\n\n  function optionsHelp(){\n    if (!command.hasOptions())\n      return '';\n\n    var hasShortOptions = Object.keys(command.short).length > 0;\n    var maxNameLength = MIN_OFFSET - 2;\n    var lines = Object.keys(command.long).sort().map(function(name){\n      var option = command.long[name];\n      var line = {\n        name: option.usage\n          .replace(/^(?:-., |)/, function(m){\n            return m || (hasShortOptions ? '    ' : '');\n          })\n          .replace(/(^|\\s)(-[^\\s,]+)/ig, function(m, p, flag){\n            return p + chalk.yellow(flag);\n          }),\n        description: option.description\n      };\n\n      maxNameLength = Math.max(maxNameLength, stringLength(line.name));\n\n      return line;\n    });\n\n    // Prepend the help information\n    return [\n      '',\n      'Options:',\n      '',\n      lines.map(function(line){\n        return '  ' + pad(maxNameLength, line.name) + '  ' + breakByLines(line.description, maxNameLength + 4);\n      }).join('\\n'),\n      ''\n    ].join('\\n');\n  }\n\n  var output = [];\n  var chalk = require('chalk');\n\n  chalk.enabled = module.exports.color && process.stdout.isTTY;\n\n  if (command.description_)\n    output.push(command.description_ + '\\n');\n\n  output.push(\n    'Usage:\\n\\n  ' +\n      chalk.cyan(commandsPath ? commandsPath.join(' ') : command.name) +\n      (command.params ? ' ' + chalk.magenta(args(command)) : '') +\n      (command.hasOptions() ? ' [' + chalk.yellow('options') + ']' : '') +\n      (command.hasCommands() ? ' [' + chalk.green('command') + ']' : ''),\n    commandsHelp() +\n    optionsHelp()\n  );\n\n  return output.join('\\n');\n};\n\n\n//\n// export\n//\n\nmodule.exports = {\n  color: true,\n\n  Error: SyntaxError,\n  Argument: Argument,\n  Command: Command,\n  Option: Option,\n\n  error: function(fn){\n    if (errorHandler)\n      throw new SyntaxError('Error handler should be set only once');\n\n    if (typeof fn != 'function')\n      throw new SyntaxError('Error handler should be a function');\n\n    errorHandler = fn;\n\n    return this;\n  },\n\n  create: function(name, params){\n    return new Command(name || require('path').basename(process.argv[1]) || 'cli', params);\n  },\n\n  confirm: function(message, fn){\n    process.stdout.write(message);\n    process.stdin.setEncoding('utf8');\n    process.stdin.once('data', function(val){\n      process.stdin.pause();\n      fn(/^y|yes|ok|true$/i.test(val.trim()));\n    });\n    process.stdin.resume();\n  }\n};\n"]}