{"version":3,"sources":["coa.js"],"names":[],"mappings":";;AAAA,IAAI,SAAS,QAAQ,MAAR,EAAgB,MAA7B;AAAA,IACI,MAAM,QAAQ,IAAR,CADV;;AAGA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAS,KAAT,EAAgB,YAAW;;AAEvB,aAAS,gBAAT,EAA2B,YAAW;;AAElC,YAAI,MAAM,IAAI,GAAJ,EAAV;;AAEA,WAAG,aAAH,EAAkB,YAAW;AACzB,mBAAO,IAAI,EAAJ,CAAO,CAAC,IAAD,CAAP,EACF,IADE,CACG,OAAO,IADV,EACgB,OADhB,CAAP;AAEH,SAHD;AAKH,KATD;;AAWA,aAAS,eAAT,EAA0B,YAAW;;AAEjC,YAAI,MAAM,IAAI,GAAJ,GACL,GADK,GAED,IAFC,CAEI,GAFJ,EAGD,KAHC,CAGK,GAHL,EAID,GAJC,GAKL,GALK,GAMD,IANC,CAMI,GANJ,EAOD,KAPC,CAOK,GAPL,EAQD,GARC,GASL,GATK,CASD,UAAS,IAAT,EAAe;AAChB,mBAAO,IAAP;AACH,SAXK,CAAV;;AAaA,WAAG,6BAAH,EAAkC,YAAW;AACzC,mBAAO,IAAI,EAAJ,CAAO,CAAC,IAAD,EAAO,GAAP,EAAY,IAAZ,EAAkB,GAAlB,CAAP,EACF,IADE,CACG,UAAS,GAAT,EAAc;AAChB,uBAAO,SAAP,CAAiB,GAAjB,EAAsB,EAAE,GAAG,GAAL,EAAU,GAAG,GAAb,EAAtB;AACH,aAHE,CAAP;AAIH,SALD;AAOH,KAtBD;;AAwBA,aAAS,cAAT,EAAyB,YAAW;;AAEhC,YAAI,MAAM,IAAI,GAAJ,GACL,GADK,GAED,IAFC,CAEI,OAFJ,EAGD,IAHC,CAGI,OAHJ,EAID,GAJC,GAKL,GALK,GAMD,IANC,CAMI,OANJ,EAOD,IAPC,CAOI,OAPJ,EAQD,GARC,GASL,GATK,CASD,UAAS,IAAT,EAAe;AAChB,mBAAO,IAAP;AACH,SAXK,CAAV;;AAaA,WAAG,6BAAH,EAAkC,YAAW;AACzC,mBAAO,IAAI,EAAJ,CAAO,CAAC,SAAD,EAAY,YAAZ,EAA0B,4BAA1B,CAAP,EACF,IADE,CACG,UAAS,GAAT,EAAc;AAChB,uBAAO,SAAP,CAAiB,GAAjB,EAAsB,EAAE,OAAO,YAAT,EAAuB,OAAO,oBAA9B,EAAtB;AACH,aAHE,CAAP;AAIH,SALD;AAOH,KAtBD;;AAwBA,aAAS,cAAT,EAAyB,YAAW;;AAEhC,YAAI,MAAM,IAAI,GAAJ,GACL,GADK,GAED,IAFC,CAEI,GAFJ,EAGD,KAHC,CAGK,GAHL,EAID,GAJC,GAKD,GALC,GAML,GANK,CAMD,UAAS,IAAT,EAAe;AAChB,mBAAO,IAAP;AACH,SARK,CAAV;;AAUA,WAAG,sCAAH,EAA2C,YAAW;AAClD,mBAAO,IAAI,EAAJ,CAAO,CAAC,IAAD,EAAO,GAAP,EAAY,IAAZ,EAAkB,GAAlB,CAAP,EACF,IADE,CACG,UAAS,GAAT,EAAc;AAChB,uBAAO,SAAP,CAAiB,GAAjB,EAAsB,EAAE,GAAG,CAAC,GAAD,EAAM,GAAN,CAAL,EAAtB;AACH,aAHE,CAAP;AAIH,SALD;AAOH,KAnBD;;AAqBA,aAAS,iBAAT,EAA4B,YAAW;;AAEnC,YAAI,MAAM,IAAI,GAAJ,GACL,GADK,GAED,IAFC,CAEI,GAFJ,EAGD,KAHC,CAGK,GAHL,EAID,GAJC,GAKD,GALC,GAML,GANK,CAMD,UAAS,IAAT,EAAe;AAChB,mBAAO,IAAP;AACH,SARK,CAAV;;AAUA,WAAG,8BAAH,EAAmC,YAAW;AAC1C,mBAAO,IAAI,EAAJ,GACF,IADE,CACG,OAAO,IADV,EACgB,OADhB,CAAP;AAEH,SAHD;;AAKA,WAAG,yCAAH,EAA8C,YAAW;AACrD,mBAAO,IAAI,EAAJ,CAAO,CAAC,IAAD,EAAO,MAAP,CAAP,EACF,IADE,CACG,UAAS,IAAT,EAAe;AACjB,uBAAO,KAAP,CAAa,KAAK,CAAlB,EAAqB,MAArB;AACH,aAHE,CAAP;AAIH,SALD;AAOH,KAxBD;;AA0BA,aAAS,2BAAT,EAAsC,YAAW;;AAE7C,YAAI,MAAM,IAAI,GAAJ,GACL,GADK,GAED,IAFC,CAEI,GAFJ,EAGD,KAHC,CAGK,GAHL,EAID,GAJC,CAIG,KAJH,EAKD,GALC,GAML,GANK,CAMD,UAAS,IAAT,EAAe;AAChB,mBAAO,IAAP;AACH,SARK,CAAV;;AAUA,WAAG,8CAAH,EAAmD,YAAW;AAC1D,mBAAO,IAAI,EAAJ,GACF,IADE,CACG,UAAS,IAAT,EAAe;AACjB,uBAAO,KAAP,CAAa,KAAK,CAAlB,EAAqB,KAArB;AACH,aAHE,CAAP;AAIH,SALD;;AAOA,WAAG,yCAAH,EAA8C,YAAW;AACrD,mBAAO,IAAI,EAAJ,CAAO,CAAC,IAAD,EAAO,MAAP,CAAP,EACF,IADE,CACG,UAAS,IAAT,EAAe;AACjB,uBAAO,KAAP,CAAa,KAAK,CAAlB,EAAqB,MAArB;AACH,aAHE,CAAP;AAIH,SALD;AAOH,KA1BD;;AA4BA,aAAS,gCAAT,EAA2C,YAAW;;AAElD,YAAI,MAAM,IAAI,GAAJ,GACL,GADK,GAED,IAFC,CAEI,GAFJ,EAGD,KAHC,CAGK,GAHL,EAID,GAJC,CAIG,UAAS,CAAT,EAAY;AACb,gBAAI,MAAM,SAAV,EAAqB,OAAO,KAAK,MAAL,CAAY,MAAZ,CAAP;AACrB,mBAAO,EAAE,OAAO,CAAT,EAAP;AACH,SAPC,EAQD,GARC,GASL,GATK,CASD,UAAS,IAAT,EAAe;AAChB,mBAAO,IAAP;AACH,SAXK,CAAV;;AAaA,WAAG,+CAAH,EAAoD,YAAW;AAC3D,mBAAO,IAAI,EAAJ,CAAO,CAAC,IAAD,EAAO,SAAP,CAAP,EACF,IADE,CACG,OAAO,IADV,EACgB,OADhB,CAAP;AAEH,SAHD;;AAKA,WAAG,iCAAH,EAAsC,YAAW;AAC7C,mBAAO,IAAI,EAAJ,CAAO,CAAC,IAAD,EAAO,MAAP,CAAP,EACF,IADE,CACG,UAAS,IAAT,EAAe;AACjB,uBAAO,SAAP,CAAiB,KAAK,CAAtB,EAAyB,EAAE,OAAO,MAAT,EAAzB;AACH,aAHE,CAAP;AAIH,SALD;AAOH,KA3BD;;AA6BA,aAAS,8BAAT,EAAyC,YAAW;;AAEhD,YAAI,MAAM,QAAQ,iBAAR,EAA2B,OAArC;AAAA,YACI,MAAM,IAAI,GAAJ,GACD,GADC,GAEG,IAFH,CAEQ,SAFR,EAGG,IAHH,CAGQ,SAHR,EAIG,IAJH,GAKG,IALH,GAMG,GANH,CAMO,YAAW;AACZ,mBAAO,GAAP;AACH,SARH,EASG,GATH,GAUD,GAVC,GAWG,IAXH,CAWQ,KAXR,EAYG,KAZH,CAYS,GAZT,EAaG,GAbH,GAcG,GAdH,EADV;;AAiBA,WAAG,kCAAH,EAAuC,YAAW;AAC9C,mBAAO,IAAI,EAAJ,CAAO,CAAC,WAAD,CAAP,EACF,IADE,CACG,OAAO,IADV,EACgB,UAAS,GAAT,EAAc;AAC7B,uBAAO,KAAP,CAAa,GAAb,EAAkB,GAAlB;AACH,aAHE,CAAP;AAIH,SALD;AAOH,KA1BD;;AA4BA,OAAG,SAAH;AACA,OAAG,UAAH;AAEH,CApMD;;AAsMA,SAAS,KAAT,EAAgB,YAAW;;AAEvB,aAAS,aAAT,EAAwB,YAAW;;AAE/B,YAAI,MAAM,IAAI,GAAJ,EAAV;;AAEA,WAAG,aAAH,EAAkB,YAAW;AACzB,mBAAO,IAAI,EAAJ,CAAO,CAAC,MAAD,CAAP,EACF,IADE,CACG,OAAO,IADV,EACgB,OADhB,CAAP;AAEH,SAHD;AAKH,KATD;;AAWA,aAAS,yBAAT,EAAoC,YAAW;;AAE3C,YAAI,MAAM,IAAI,GAAJ,GACL,GADK,GAED,IAFC,CAEI,GAFJ,EAGD,GAHC,EAAV;;AAKA,WAAG,aAAH,EAAkB,YAAW;AACzB,mBAAO,IAAI,EAAJ,CAAO,CAAC,MAAD,EAAS,SAAT,CAAP,EACF,IADE,CACG,OAAO,IADV,EACgB,OADhB,CAAP;AAEH,SAHD;AAKH,KAZD;;AAcA,aAAS,WAAT,EAAsB,YAAW;;AAE7B,YAAI,MAAM,IAAI,GAAJ,GACL,GADK,GAED,IAFC,CAEI,GAFJ,EAGD,GAHC,GAID,GAJC,GAKL,GALK,CAKD,UAAS,IAAT,EAAe,IAAf,EAAqB;AACtB,mBAAO,IAAP;AACH,SAPK,CAAV;;AASA,WAAG,sCAAH,EAA2C,YAAW;AAClD,mBAAO,IAAI,EAAJ,CAAO,CAAC,SAAD,EAAY,SAAZ,CAAP,EACF,IADE,CACG,UAAS,IAAT,EAAe;AACjB,uBAAO,SAAP,CAAiB,IAAjB,EAAuB,EAAE,GAAG,CAAC,SAAD,EAAY,SAAZ,CAAL,EAAvB;AACH,aAHE,CAAP;AAIH,SALD;AAOH,KAlBD;;AAoBA,aAAS,cAAT,EAAyB,YAAW;;AAEhC,YAAI,MAAM,IAAI,GAAJ,GACL,GADK,GAED,IAFC,CAEI,GAFJ,EAGD,GAHC,GAID,GAJC,GAKL,GALK,CAKD,UAAS,IAAT,EAAe,IAAf,EAAqB;AACtB,mBAAO,IAAP;AACH,SAPK,CAAV;;AASA,WAAG,8BAAH,EAAmC,YAAW;AAC1C,mBAAO,IAAI,EAAJ,GACF,IADE,CACG,OAAO,IADV,EACgB,OADhB,CAAP;AAEH,SAHD;;AAKA,WAAG,yCAAH,EAA8C,YAAW;AACrD,mBAAO,IAAI,EAAJ,CAAO,CAAC,OAAD,CAAP,EACF,IADE,CACG,UAAS,IAAT,EAAe;AACjB,uBAAO,KAAP,CAAa,KAAK,CAAlB,EAAqB,OAArB;AACH,aAHE,CAAP;AAIH,SALD;AAOH,KAvBD;;AAyBA,aAAS,oBAAT,EAA+B,YAAW;;AAEtC,YAAI,MAAM,IAAI,GAAJ,GACL,GADK,GAED,IAFC,CAEI,KAFJ,EAGD,IAHC,CAGI,KAHJ,EAID,GAJC,GAKL,GALK,GAMD,IANC,CAMI,MANJ,EAOD,GAPC,GAQL,GARK,GASD,IATC,CASI,MATJ,EAUD,GAVC,GAWD,GAXC,GAYL,GAZK,CAYD,UAAS,IAAT,EAAe,IAAf,EAAqB;AACtB,mBAAO,EAAE,MAAM,IAAR,EAAc,MAAM,IAApB,EAAP;AACH,SAdK,CAAV;;AAgBA,WAAG,6BAAH,EAAkC,YAAW;AACzC,mBAAO,IAAI,EAAJ,CAAO,CAAC,OAAD,EAAU,OAAV,EAAmB,OAAnB,EAA4B,SAA5B,EAAuC,SAAvC,CAAP,EACF,IADE,CACG,UAAS,CAAT,EAAY;AACd,uBAAO,SAAP,CAAiB,CAAjB,EAAoB;AAChB,0BAAM,EAAE,KAAK,OAAP,EADU;AAEhB,0BAAM;AACF,8BAAM,OADJ;AAEF,8BAAM,CAAC,SAAD,EAAY,SAAZ;AAFJ;AAFU,iBAApB;AAOH,aATE,CAAP;AAUH,SAXD;AAaH,KA/BD;;AAiCA,aAAS,UAAT,EAAqB,YAAW;;AAE5B,YAAI,MAAM,IAAI,GAAJ,GACL,GADK,GAED,IAFC,CAEI,KAFJ,EAGD,GAHC,GAID,GAJC,GAKL,GALK,CAKD,UAAS,IAAT,EAAe,IAAf,EAAqB;AACtB,mBAAO,IAAP;AACH,SAPK,CAAV;;AASA,WAAG,iCAAH,EAAsC,YAAW;AAC7C,mBAAO,IAAI,EAAJ,CAAO,CAAC,IAAD,EAAO,KAAP,EAAc,KAAd,EAAqB,QAArB,CAAP,EACF,IADE,CACG,UAAS,IAAT,EAAe;AACjB,uBAAO,SAAP,CAAiB,IAAjB,EAAuB,EAAE,KAAK,CAAC,KAAD,EAAQ,KAAR,EAAe,QAAf,CAAP,EAAvB;AACH,aAHE,CAAP;AAIH,SALD;AAOH,KAlBD;AAoBH,CA7HD;;AA+HA,SAAS,KAAT,EAAgB,YAAW;;AAEvB,QAAI,SAAS,SAAT,MAAS,CAAS,CAAT,EAAY;AACjB,eAAO,SAAP,CAAiB,CAAjB,EAAoB;AAChB,kBAAM,EAAE,KAAK,OAAP,EADU;AAEhB,kBAAM;AACF,sBAAM,OADJ;AAEF,sBAAM,CAAC,SAAD,EAAY,SAAZ;AAFJ;AAFU,SAApB;AAOH,KARL;AAAA,QAUI,aAAa,EAAE,KAAK,OAAP,EAVjB;AAAA,QAWI,aAAa;AACT,cAAM,OADG;AAET,cAAO,CAAC,SAAD,EAAY,SAAZ;AAFE,KAXjB;;AAgBA,aAAS,YAAT,EAAuB,YAAW;;AAE9B,YAAI,MAAM,IAAI,GAAJ,GACL,GADK,GAED,IAFC,CAEI,SAFJ,EAGD,GAHC,GAIG,IAJH,CAIQ,KAJR,EAKG,IALH,CAKQ,KALR,EAMG,GANH,GAOD,GAPC,GAQG,IARH,CAQQ,MARR,EASG,GATH,GAUD,GAVC,GAWG,IAXH,CAWQ,MAXR,EAYG,GAZH,GAaG,GAbH,GAcD,GAdC,CAcG,UAAS,IAAT,EAAe,IAAf,EAAqB;AACtB,mBAAO,EAAE,MAAM,IAAR,EAAc,MAAM,IAApB,EAAP;AACH,SAhBC,EAiBD,GAjBC,EAAV;;AAmBA,iBAAS,gCAAT,EAA2C,YAAW;;AAElD,eAAG,mDAAH,EAAwD,YAAW;AAC/D,uBAAO,IAAI,EAAJ,CAAO,CAAC,SAAD,EAAY,OAAZ,EAAqB,OAArB,EAA8B,OAA9B,EAAuC,SAAvC,EAAkD,SAAlD,CAAP,EACF,IADE,CACG,MADH,CAAP;AAEH,aAHD;AAKH,SAPD;;AASA,iBAAS,wBAAT,EAAmC,YAAW;;AAE1C,eAAG,mDAAH,EAAwD,YAAW;AAC/D,uBAAO,IAAI,GAAJ,CAAQ,OAAR,CAAgB,UAAhB,EAA4B,UAA5B,EACF,IADE,CACG,MADH,CAAP;AAEH,aAHD;AAKH,SAPD;;AASA,iBAAS,6BAAT,EAAwC,YAAW;;AAE/C,eAAG,mDAAH,EAAwD,YAAW;AAC/D,uBAAO,IAAI,MAAJ,CAAW,SAAX,EAAsB,UAAtB,EAAkC,UAAlC,EACF,IADE,CACG,MADH,CAAP;AAEH,aAHD;AAKH,SAPD;;AASA,iBAAS,gDAAT,EAA2D,YAAW;;AAElE,eAAG,aAAH,EAAkB,YAAW;AACzB,uBAAO,IAAI,MAAJ,CAAW,YAAX,EACF,IADE,CACG,OAAO,IADV,EACgB,OADhB,CAAP;AAEH,aAHD;AAKH,SAPD;AASH,KAzDD;;AA2DA,aAAS,qBAAT,EAAgC,YAAW;;AAEvC,iBAAS,kCAAT,EAA6C,YAAW;;AAEpD,qBAAS,8BAAT,EAAyC,YAAW;AAChD,oBAAI,MAAM,IAAI,GAAJ,GACL,IADK,CACA,KADA,EAEL,UAFK,EAAV;;AAIA,mBAAG,mDAAH,EAAwD,YAAW;AAC/D,2BAAO,IAAI,EAAJ,CAAO,CAAC,MAAD,EAAS,OAAT,EAAkB,OAAlB,EAA2B,OAA3B,EAAoC,SAApC,EAA+C,SAA/C,CAAP,EACF,IADE,CACG,MADH,CAAP;AAEH,iBAHD;AAIH,aATD;;AAWA,qBAAS,uCAAT,EAAkD,YAAW;AACzD,oBAAI,MAAM,IAAI,GAAJ,GACL,IADK,CACA,KADA,EAEL,UAFK,EAAV;;AAIA,mBAAG,mDAAH,EAAwD,YAAW;AAC/D,2BAAO,IAAI,EAAJ,CAAO,CAAC,UAAD,EAAa,OAAb,EAAsB,OAAtB,EAA+B,OAA/B,EAAwC,SAAxC,EAAmD,SAAnD,CAAP,EACF,IADE,CACG,MADH,CAAP;AAEH,iBAHD;AAIH,aATD;;AAWA,qBAAS,sBAAT,EAAiC,YAAW;AACxC,oBAAI,MAAM,IAAI,GAAJ,GACL,IADK,CACA,KADA,EAEL,GAFK,GAGL,IAHK,CAGA,MAHA,EAIL,UAJK,GAKL,GALK,EAAV;;AAOA,mBAAG,mDAAH,EAAwD,YAAW;AAC/D,2BAAO,IAAI,EAAJ,CAAO,CAAC,MAAD,EAAS,KAAT,EAAgB,OAAhB,EAAyB,OAAzB,EAAkC,OAAlC,EAA2C,SAA3C,EAAsD,SAAtD,CAAP,EACF,IADE,CACG,MADH,CAAP;AAEH,iBAHD;AAIH,aAZD;AAcH,SAtCD;;AAwCA,iBAAS,uCAAT,EAAkD,YAAW;;AAEzD,qBAAS,8BAAT,EAAyC,YAAW;AAChD,oBAAI,MAAM,IAAI,GAAJ,GACL,IADK,CACA,KADA,EAEL,UAFK,CAEM,MAFN,CAAV;;AAIA,mBAAG,mDAAH,EAAwD,YAAW;AAC/D,2BAAO,IAAI,EAAJ,CAAO,CAAC,MAAD,EAAS,OAAT,EAAkB,OAAlB,EAA2B,OAA3B,EAAoC,SAApC,EAA+C,SAA/C,CAAP,EACF,IADE,CACG,MADH,CAAP;AAEH,iBAHD;AAIH,aATD;AAWH,SAbD;;AAeA,iBAAS,yCAAT,EAAoD,YAAW;;AAE3D,qBAAS,8BAAT,EAAyC,YAAW;AAChD,oBAAI,MAAM,IAAI,GAAJ,GACL,IADK,CACA,KADA,EAEL,UAFK,CAEM,QAFN,CAAV;;AAIA,mBAAG,mDAAH,EAAwD,YAAW;AAC/D,2BAAO,IAAI,EAAJ,CAAO,CAAC,MAAD,EAAS,OAAT,EAAkB,OAAlB,EAA2B,OAA3B,EAAoC,SAApC,EAA+C,SAA/C,CAAP,EACF,IADE,CACG,MADH,CAAP;AAEH,iBAHD;AAIH,aATD;AAWH,SAbD;AAeH,KAxED;;AA0EA,OAAG,4BAAH;AAEH,CAzJD;;AA2JA,SAAS,OAAT,GAAmB;AACf;AACH","file":"coa-compiled.js","sourcesContent":["var assert = require('chai').assert,\n    COA = require('..');\n\n/**\n * Mocha BDD interface.\n */\n/** @name describe @function */\n/** @name it @function */\n/** @name before @function */\n/** @name after @function */\n/** @name beforeEach @function */\n/** @name afterEach @function */\n\ndescribe('Opt', function() {\n\n    describe('Unknown option', function() {\n\n        var cmd = COA.Cmd();\n\n        it('should fail', function() {\n            return cmd.do(['-a'])\n                .then(assert.fail, emptyFn);\n        });\n\n    });\n\n    describe('Short options', function() {\n\n        var cmd = COA.Cmd()\n            .opt()\n                .name('a')\n                .short('a')\n                .end()\n            .opt()\n                .name('b')\n                .short('b')\n                .end()\n            .act(function(opts) {\n                return opts;\n            });\n\n        it('should return passed values', function() {\n            return cmd.do(['-a', 'a', '-b', 'b'])\n                .then(function(res) {\n                    assert.deepEqual(res, { a: 'a', b: 'b' });\n                });\n        });\n\n    });\n\n    describe('Long options', function() {\n\n        var cmd = COA.Cmd()\n            .opt()\n                .name('long1')\n                .long('long1')\n                .end()\n            .opt()\n                .name('long2')\n                .long('long2')\n                .end()\n            .act(function(opts) {\n                return opts;\n            });\n\n        it('should return passed values', function() {\n            return cmd.do(['--long1', 'long value', '--long2=another long value'])\n                .then(function(res) {\n                    assert.deepEqual(res, { long1: 'long value', long2: 'another long value' });\n                });\n        });\n\n    });\n\n    describe('Array option', function() {\n\n        var cmd = COA.Cmd()\n            .opt()\n                .name('a')\n                .short('a')\n                .arr()\n                .end()\n            .act(function(opts) {\n                return opts;\n            });\n\n        it('should return array of passed values', function() {\n            return cmd.do(['-a', '1', '-a', '2'])\n                .then(function(res) {\n                    assert.deepEqual(res, { a: ['1', '2'] });\n                });\n        });\n\n    });\n\n    describe('Required option', function() {\n\n        var cmd = COA.Cmd()\n            .opt()\n                .name('a')\n                .short('a')\n                .req()\n                .end()\n            .act(function(opts) {\n                return opts;\n            });\n\n        it('should fail if not specified', function() {\n            return cmd.do()\n                .then(assert.fail, emptyFn);\n        });\n\n        it('should return passed value if specified', function() {\n            return cmd.do(['-a', 'test'])\n                .then(function(opts) {\n                    assert.equal(opts.a, 'test');\n                });\n        });\n\n    });\n\n    describe('Option with default value', function() {\n\n        var cmd = COA.Cmd()\n            .opt()\n                .name('a')\n                .short('a')\n                .def('aaa')\n                .end()\n            .act(function(opts) {\n                return opts;\n            });\n\n        it('should return default value if not specified', function() {\n            return cmd.do()\n                .then(function(opts) {\n                    assert.equal(opts.a, 'aaa');\n                });\n        });\n\n        it('should return passed value if specified', function() {\n            return cmd.do(['-a', 'test'])\n                .then(function(opts) {\n                    assert.equal(opts.a, 'test');\n                });\n        });\n\n    });\n\n    describe('Validated / transformed option', function() {\n\n        var cmd = COA.Cmd()\n            .opt()\n                .name('a')\n                .short('a')\n                .val(function(v) {\n                    if (v === 'invalid') return this.reject('fail');\n                    return { value: v };\n                })\n                .end()\n            .act(function(opts) {\n                return opts;\n            });\n\n        it('should fail if custom checks suppose to do so', function() {\n            return cmd.do(['-a', 'invalid'])\n                .then(assert.fail, emptyFn);\n        });\n\n        it('should return transformed value', function() {\n            return cmd.do(['-a', 'test'])\n                .then(function(opts) {\n                    assert.deepEqual(opts.a, { value: 'test' });\n                });\n        });\n\n    });\n\n    describe('Only option (--version case)', function() {\n\n        var ver = require('../package.json').version,\n            cmd = COA.Cmd()\n                .opt()\n                    .name('version')\n                    .long('version')\n                    .flag()\n                    .only()\n                    .act(function() {\n                        return ver;\n                    })\n                    .end()\n                .opt()\n                    .name('req')\n                    .short('r')\n                    .req()\n                    .end();\n\n        it('should process the only() option', function() {\n            return cmd.do(['--version'])\n                .then(assert.fail, function(res) {\n                    assert.equal(res, ver);\n                });\n        });\n\n    });\n\n    it('input()');\n    it('output()');\n\n});\n\ndescribe('Arg', function() {\n\n    describe('Unknown arg', function() {\n\n        var cmd = COA.Cmd();\n\n        it('should fail', function() {\n            return cmd.do(['test'])\n                .then(assert.fail, emptyFn);\n        });\n\n    });\n\n    describe('Unknown arg after known', function() {\n\n        var cmd = COA.Cmd()\n            .arg()\n                .name('a')\n                .end();\n\n        it('should fail', function() {\n            return cmd.do(['test', 'unknown'])\n                .then(assert.fail, emptyFn);\n        });\n\n    });\n\n    describe('Array arg', function() {\n\n        var cmd = COA.Cmd()\n            .arg()\n                .name('a')\n                .arr()\n                .end()\n            .act(function(opts, args) {\n                return args;\n            });\n\n        it('should return array of passed values', function() {\n            return cmd.do(['value 1', 'value 2'])\n                .then(function(args) {\n                    assert.deepEqual(args, { a: ['value 1', 'value 2'] });\n                });\n        });\n\n    });\n\n    describe('Required arg', function() {\n\n        var cmd = COA.Cmd()\n            .arg()\n                .name('a')\n                .req()\n                .end()\n            .act(function(opts, args) {\n                return args;\n            });\n\n        it('should fail if not specified', function() {\n            return cmd.do()\n                .then(assert.fail, emptyFn);\n        });\n\n        it('should return passed value if specified', function() {\n            return cmd.do(['value'])\n                .then(function(args) {\n                    assert.equal(args.a, 'value');\n                });\n        });\n\n    });\n\n    describe('Args after options', function() {\n\n        var cmd = COA.Cmd()\n            .opt()\n                .name('opt')\n                .long('opt')\n                .end()\n            .arg()\n                .name('arg1')\n                .end()\n            .arg()\n                .name('arg2')\n                .arr()\n                .end()\n            .act(function(opts, args) {\n                return { opts: opts, args: args };\n            });\n\n        it('should return passed values', function() {\n            return cmd.do(['--opt', 'value', 'value', 'value 1', 'value 2'])\n                .then(function(o) {\n                    assert.deepEqual(o, {\n                        opts: { opt: 'value' },\n                        args: {\n                            arg1: 'value',\n                            arg2: ['value 1', 'value 2']\n                        }\n                    });\n                });\n        });\n\n    });\n\n    describe('Raw args', function() {\n\n        var cmd = COA.Cmd()\n            .arg()\n                .name('raw')\n                .arr()\n                .end()\n            .act(function(opts, args) {\n                return args;\n            });\n\n        it('should return passed arg values', function() {\n            return cmd.do(['--', 'raw', 'arg', 'values'])\n                .then(function(args) {\n                    assert.deepEqual(args, { raw: ['raw', 'arg', 'values'] });\n                });\n        });\n\n    });\n\n});\n\ndescribe('Cmd', function() {\n\n    var doTest = function(o) {\n            assert.deepEqual(o, {\n                opts: { opt: 'value' },\n                args: {\n                    arg1: 'value',\n                    arg2: ['value 1', 'value 2']\n                }\n            });\n        },\n\n        invokeOpts = { opt: 'value' },\n        invokeArgs = {\n            arg1: 'value',\n            arg2:  ['value 1', 'value 2']\n        };\n\n    describe('Subcommand', function() {\n\n        var cmd = COA.Cmd()\n            .cmd()\n                .name('command')\n                .opt()\n                    .name('opt')\n                    .long('opt')\n                    .end()\n                .arg()\n                    .name('arg1')\n                    .end()\n                .arg()\n                    .name('arg2')\n                    .arr()\n                    .end()\n                .act(function(opts, args) {\n                    return { opts: opts, args: args };\n                })\n                .end();\n\n        describe('when specified on command line', function() {\n\n            it('should be invoked and accept passed opts and args', function() {\n                return cmd.do(['command', '--opt', 'value', 'value', 'value 1', 'value 2'])\n                    .then(doTest);\n            });\n\n        });\n\n        describe('when invoked using api', function() {\n\n            it('should be invoked and accept passed opts and args', function() {\n                return cmd.api.command(invokeOpts, invokeArgs)\n                    .then(doTest);\n            });\n\n        });\n\n        describe('when invoked using invoke()', function() {\n\n            it('should be invoked and accept passed opts and args', function() {\n                return cmd.invoke('command', invokeOpts, invokeArgs)\n                    .then(doTest);\n            });\n\n        });\n\n        describe('when unexisting command invoked using invoke()', function() {\n\n            it('should fail', function() {\n                return cmd.invoke('unexistent')\n                    .then(assert.fail, emptyFn);\n            });\n\n        });\n\n    });\n\n    describe('External subcommand', function() {\n\n        describe('default scheme: cmd.extendable()', function() {\n\n            describe('when described as a function', function() {\n                var cmd = COA.Cmd()\n                    .name('coa')\n                    .extendable();\n\n                it('should be invoked and accept passed opts and args', function() {\n                    return cmd.do(['test', '--opt', 'value', 'value', 'value 1', 'value 2'])\n                        .then(doTest);\n                });\n            });\n\n            describe('when described as an COA.Cmd() object', function() {\n                var cmd = COA.Cmd()\n                    .name('coa')\n                    .extendable();\n\n                it('should be invoked and accept passed opts and args', function() {\n                    return cmd.do(['test-obj', '--opt', 'value', 'value', 'value 1', 'value 2'])\n                        .then(doTest);\n                });\n            });\n\n            describe('2nd level subcommand', function() {\n                var cmd = COA.Cmd()\n                    .name('coa')\n                    .cmd()\n                    .name('test')\n                    .extendable()\n                    .end();\n\n                it('should be invoked and accept passed opts and args', function() {\n                    return cmd.do(['test', 'obj', '--opt', 'value', 'value', 'value 1', 'value 2'])\n                        .then(doTest);\n                });\n            });\n\n        });\n\n        describe(\"common prefix: cmd.extendable('coa-')\", function() {\n\n            describe('when described as a function', function() {\n                var cmd = COA.Cmd()\n                    .name('coa')\n                    .extendable('coa-');\n\n                it('should be invoked and accept passed opts and args', function() {\n                    return cmd.do(['test', '--opt', 'value', 'value', 'value 1', 'value 2'])\n                        .then(doTest);\n                });\n            });\n\n        });\n\n        describe(\"format string: cmd.extendable('coa-%s')\", function() {\n\n            describe('when described as a function', function() {\n                var cmd = COA.Cmd()\n                    .name('coa')\n                    .extendable('coa-%s');\n\n                it('should be invoked and accept passed opts and args', function() {\n                    return cmd.do(['test', '--opt', 'value', 'value', 'value 1', 'value 2'])\n                        .then(doTest);\n                });\n            });\n\n        });\n\n    });\n\n    it('helpful(), name(), title()');\n\n});\n\nfunction emptyFn() {\n    // empty function\n}\n"]}