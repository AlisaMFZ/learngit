{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["// http://www.w3.org/TR/CSS21/grammar.html\n// https://github.com/visionmedia/css-parse/pull/49#issuecomment-30088027\nvar commentre = /\\/\\*[^*]*\\*+([^/*][^*]*\\*+)*\\//g\n\nmodule.exports = function(css, options){\n  options = options || {};\n\n  /**\n   * Positional.\n   */\n\n  var lineno = 1;\n  var column = 1;\n\n  /**\n   * Update lineno and column based on `str`.\n   */\n\n  function updatePosition(str) {\n    var lines = str.match(/\\n/g);\n    if (lines) lineno += lines.length;\n    var i = str.lastIndexOf('\\n');\n    column = ~i ? str.length - i : column + str.length;\n  }\n\n  /**\n   * Mark position and patch `node.position`.\n   */\n\n  function position() {\n    var start = { line: lineno, column: column };\n    return function(node){\n      node.position = new Position(start);\n      whitespace();\n      return node;\n    };\n  }\n\n  /**\n   * Store position information for a node\n   */\n\n  function Position(start) {\n    this.start = start;\n    this.end = { line: lineno, column: column };\n    this.source = options.source;\n  }\n\n  /**\n   * Non-enumerable source string\n   */\n\n  Position.prototype.content = css;\n\n  /**\n   * Error `msg`.\n   */\n\n  var errorsList = [];\n\n  function error(msg) {\n    var err = new Error(options.source + ':' + lineno + ':' + column + ': ' + msg);\n    err.reason = msg;\n    err.filename = options.source;\n    err.line = lineno;\n    err.column = column;\n    err.source = css;\n\n    if (options.silent) {\n      errorsList.push(err);\n    } else {\n      throw err;\n    }\n  }\n\n  /**\n   * Parse stylesheet.\n   */\n\n  function stylesheet() {\n    var rulesList = rules();\n\n    return {\n      type: 'stylesheet',\n      stylesheet: {\n        rules: rulesList,\n        parsingErrors: errorsList\n      }\n    };\n  }\n\n  /**\n   * Opening brace.\n   */\n\n  function open() {\n    return match(/^{\\s*/);\n  }\n\n  /**\n   * Closing brace.\n   */\n\n  function close() {\n    return match(/^}/);\n  }\n\n  /**\n   * Parse ruleset.\n   */\n\n  function rules() {\n    var node;\n    var rules = [];\n    whitespace();\n    comments(rules);\n    while (css.length && css.charAt(0) != '}' && (node = atrule() || rule())) {\n      if (node !== false) {\n        rules.push(node);\n        comments(rules);\n      }\n    }\n    return rules;\n  }\n\n  /**\n   * Match `re` and return captures.\n   */\n\n  function match(re) {\n    var m = re.exec(css);\n    if (!m) return;\n    var str = m[0];\n    updatePosition(str);\n    css = css.slice(str.length);\n    return m;\n  }\n\n  /**\n   * Parse whitespace.\n   */\n\n  function whitespace() {\n    match(/^\\s*/);\n  }\n\n  /**\n   * Parse comments;\n   */\n\n  function comments(rules) {\n    var c;\n    rules = rules || [];\n    while (c = comment()) {\n      if (c !== false) {\n        rules.push(c);\n      }\n    }\n    return rules;\n  }\n\n  /**\n   * Parse comment.\n   */\n\n  function comment() {\n    var pos = position();\n    if ('/' != css.charAt(0) || '*' != css.charAt(1)) return;\n\n    var i = 2;\n    while (\"\" != css.charAt(i) && ('*' != css.charAt(i) || '/' != css.charAt(i + 1))) ++i;\n    i += 2;\n\n    if (\"\" === css.charAt(i-1)) {\n      return error('End of comment missing');\n    }\n\n    var str = css.slice(2, i - 2);\n    column += 2;\n    updatePosition(str);\n    css = css.slice(i);\n    column += 2;\n\n    return pos({\n      type: 'comment',\n      comment: str\n    });\n  }\n\n  /**\n   * Parse selector.\n   */\n\n  function selector() {\n    var m = match(/^([^{]+)/);\n    if (!m) return;\n    /* @fix Remove all comments from selectors\n     * http://ostermiller.org/findcomment.html */\n    return trim(m[0])\n      .replace(/\\/\\*([^*]|[\\r\\n]|(\\*+([^*/]|[\\r\\n])))*\\*\\/+/g, '')\n      .replace(/\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'/g, function(m) {\n        return m.replace(/,/g, '\\u200C');\n      })\n      .split(/\\s*(?![^(]*\\)),\\s*/)\n      .map(function(s) {\n        return s.replace(/\\u200C/g, ',');\n      });\n  }\n\n  /**\n   * Parse declaration.\n   */\n\n  function declaration() {\n    var pos = position();\n\n    // prop\n    var prop = match(/^(\\*?[-#\\/\\*\\\\\\w]+(\\[[0-9a-z_-]+\\])?)\\s*/);\n    if (!prop) return;\n    prop = trim(prop[0]);\n\n    // :\n    if (!match(/^:\\s*/)) return error(\"property missing ':'\");\n\n    // val\n    var val = match(/^((?:'(?:\\\\'|.)*?'|\"(?:\\\\\"|.)*?\"|\\([^\\)]*?\\)|[^};])+)/);\n\n    var ret = pos({\n      type: 'declaration',\n      property: prop.replace(commentre, ''),\n      value: val ? trim(val[0]).replace(commentre, '') : ''\n    });\n\n    // ;\n    match(/^[;\\s]*/);\n\n    return ret;\n  }\n\n  /**\n   * Parse declarations.\n   */\n\n  function declarations() {\n    var decls = [];\n\n    if (!open()) return error(\"missing '{'\");\n    comments(decls);\n\n    // declarations\n    var decl;\n    while (decl = declaration()) {\n      if (decl !== false) {\n        decls.push(decl);\n        comments(decls);\n      }\n    }\n\n    if (!close()) return error(\"missing '}'\");\n    return decls;\n  }\n\n  /**\n   * Parse keyframe.\n   */\n\n  function keyframe() {\n    var m;\n    var vals = [];\n    var pos = position();\n\n    while (m = match(/^((\\d+\\.\\d+|\\.\\d+|\\d+)%?|[a-z]+)\\s*/)) {\n      vals.push(m[1]);\n      match(/^,\\s*/);\n    }\n\n    if (!vals.length) return;\n\n    return pos({\n      type: 'keyframe',\n      values: vals,\n      declarations: declarations()\n    });\n  }\n\n  /**\n   * Parse keyframes.\n   */\n\n  function atkeyframes() {\n    var pos = position();\n    var m = match(/^@([-\\w]+)?keyframes\\s*/);\n\n    if (!m) return;\n    var vendor = m[1];\n\n    // identifier\n    var m = match(/^([-\\w]+)\\s*/);\n    if (!m) return error(\"@keyframes missing name\");\n    var name = m[1];\n\n    if (!open()) return error(\"@keyframes missing '{'\");\n\n    var frame;\n    var frames = comments();\n    while (frame = keyframe()) {\n      frames.push(frame);\n      frames = frames.concat(comments());\n    }\n\n    if (!close()) return error(\"@keyframes missing '}'\");\n\n    return pos({\n      type: 'keyframes',\n      name: name,\n      vendor: vendor,\n      keyframes: frames\n    });\n  }\n\n  /**\n   * Parse supports.\n   */\n\n  function atsupports() {\n    var pos = position();\n    var m = match(/^@supports *([^{]+)/);\n\n    if (!m) return;\n    var supports = trim(m[1]);\n\n    if (!open()) return error(\"@supports missing '{'\");\n\n    var style = comments().concat(rules());\n\n    if (!close()) return error(\"@supports missing '}'\");\n\n    return pos({\n      type: 'supports',\n      supports: supports,\n      rules: style\n    });\n  }\n\n  /**\n   * Parse host.\n   */\n\n  function athost() {\n    var pos = position();\n    var m = match(/^@host\\s*/);\n\n    if (!m) return;\n\n    if (!open()) return error(\"@host missing '{'\");\n\n    var style = comments().concat(rules());\n\n    if (!close()) return error(\"@host missing '}'\");\n\n    return pos({\n      type: 'host',\n      rules: style\n    });\n  }\n\n  /**\n   * Parse media.\n   */\n\n  function atmedia() {\n    var pos = position();\n    var m = match(/^@media *([^{]+)/);\n\n    if (!m) return;\n    var media = trim(m[1]);\n\n    if (!open()) return error(\"@media missing '{'\");\n\n    var style = comments().concat(rules());\n\n    if (!close()) return error(\"@media missing '}'\");\n\n    return pos({\n      type: 'media',\n      media: media,\n      rules: style\n    });\n  }\n\n\n  /**\n   * Parse custom-media.\n   */\n\n  function atcustommedia() {\n    var pos = position();\n    var m = match(/^@custom-media\\s+(--[^\\s]+)\\s*([^{;]+);/);\n    if (!m) return;\n\n    return pos({\n      type: 'custom-media',\n      name: trim(m[1]),\n      media: trim(m[2])\n    });\n  }\n\n  /**\n   * Parse paged media.\n   */\n\n  function atpage() {\n    var pos = position();\n    var m = match(/^@page */);\n    if (!m) return;\n\n    var sel = selector() || [];\n\n    if (!open()) return error(\"@page missing '{'\");\n    var decls = comments();\n\n    // declarations\n    var decl;\n    while (decl = declaration()) {\n      decls.push(decl);\n      decls = decls.concat(comments());\n    }\n\n    if (!close()) return error(\"@page missing '}'\");\n\n    return pos({\n      type: 'page',\n      selectors: sel,\n      declarations: decls\n    });\n  }\n\n  /**\n   * Parse document.\n   */\n\n  function atdocument() {\n    var pos = position();\n    var m = match(/^@([-\\w]+)?document *([^{]+)/);\n    if (!m) return;\n\n    var vendor = trim(m[1]);\n    var doc = trim(m[2]);\n\n    if (!open()) return error(\"@document missing '{'\");\n\n    var style = comments().concat(rules());\n\n    if (!close()) return error(\"@document missing '}'\");\n\n    return pos({\n      type: 'document',\n      document: doc,\n      vendor: vendor,\n      rules: style\n    });\n  }\n\n  /**\n   * Parse font-face.\n   */\n\n  function atfontface() {\n    var pos = position();\n    var m = match(/^@font-face\\s*/);\n    if (!m) return;\n\n    if (!open()) return error(\"@font-face missing '{'\");\n    var decls = comments();\n\n    // declarations\n    var decl;\n    while (decl = declaration()) {\n      decls.push(decl);\n      decls = decls.concat(comments());\n    }\n\n    if (!close()) return error(\"@font-face missing '}'\");\n\n    return pos({\n      type: 'font-face',\n      declarations: decls\n    });\n  }\n\n  /**\n   * Parse import\n   */\n\n  var atimport = _compileAtrule('import');\n\n  /**\n   * Parse charset\n   */\n\n  var atcharset = _compileAtrule('charset');\n\n  /**\n   * Parse namespace\n   */\n\n  var atnamespace = _compileAtrule('namespace');\n\n  /**\n   * Parse non-block at-rules\n   */\n\n\n  function _compileAtrule(name) {\n    var re = new RegExp('^@' + name + '\\\\s*([^;]+);');\n    return function() {\n      var pos = position();\n      var m = match(re);\n      if (!m) return;\n      var ret = { type: name };\n      ret[name] = m[1].trim();\n      return pos(ret);\n    }\n  }\n\n  /**\n   * Parse at rule.\n   */\n\n  function atrule() {\n    if (css[0] != '@') return;\n\n    return atkeyframes()\n      || atmedia()\n      || atcustommedia()\n      || atsupports()\n      || atimport()\n      || atcharset()\n      || atnamespace()\n      || atdocument()\n      || atpage()\n      || athost()\n      || atfontface();\n  }\n\n  /**\n   * Parse rule.\n   */\n\n  function rule() {\n    var pos = position();\n    var sel = selector();\n\n    if (!sel) return error('selector missing');\n    comments();\n\n    return pos({\n      type: 'rule',\n      selectors: sel,\n      declarations: declarations()\n    });\n  }\n\n  return addParent(stylesheet());\n};\n\n/**\n * Trim `str`.\n */\n\nfunction trim(str) {\n  return str ? str.replace(/^\\s+|\\s+$/g, '') : '';\n}\n\n/**\n * Adds non-enumerable parent node reference to each node.\n */\n\nfunction addParent(obj, parent) {\n  var isNode = obj && typeof obj.type === 'string';\n  var childParent = isNode ? obj : parent;\n\n  for (var k in obj) {\n    var value = obj[k];\n    if (Array.isArray(value)) {\n      value.forEach(function(v) { addParent(v, childParent); });\n    } else if (value && typeof value === 'object') {\n      addParent(value, childParent);\n    }\n  }\n\n  if (isNode) {\n    Object.defineProperty(obj, 'parent', {\n      configurable: true,\n      writable: true,\n      enumerable: false,\n      value: parent || null\n    });\n  }\n\n  return obj;\n}\n"]}