{"version":3,"sources":["cli.js"],"names":[],"mappings":"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","file":"cli-compiled.js","sourcesContent":["var fs = require('fs');\nvar path = require('path');\nvar cli = require('clap');\nvar SourceMapConsumer = require('source-map').SourceMapConsumer;\nvar csso = require('./index.js');\n\nfunction readFromStream(stream, minify) {\n    var buffer = [];\n\n    // FIXME: don't chain until node.js 0.10 drop, since setEncoding isn't chainable in 0.10\n    stream.setEncoding('utf8');\n    stream\n        .on('data', function(chunk) {\n            buffer.push(chunk);\n        })\n        .on('end', function() {\n            minify(buffer.join(''));\n        });\n}\n\nfunction showStat(filename, source, result, inputMap, map, time, mem) {\n    function fmt(size) {\n        return String(size).split('').reverse().reduce(function(size, digit, idx) {\n            if (idx && idx % 3 === 0) {\n                size = ' ' + size;\n            }\n            return digit + size;\n        }, '');\n    }\n\n    map = map || 0;\n    result -= map;\n\n    console.error('Source:    ', filename === '<stdin>' ? filename : path.relative(process.cwd(), filename));\n    if (inputMap) {\n        console.error('Map source:', inputMap);\n    }\n    console.error('Original:  ', fmt(source), 'bytes');\n    console.error('Compressed:', fmt(result), 'bytes', '(' + (100 * result / source).toFixed(2) + '%)');\n    console.error('Saving:    ', fmt(source - result), 'bytes', '(' + (100 * (source - result) / source).toFixed(2) + '%)');\n    if (map) {\n        console.error('Source map:', fmt(map), 'bytes', '(' + (100 * map / (result + map)).toFixed(2) + '% of total)');\n        console.error('Total:     ', fmt(map + result), 'bytes');\n    }\n    console.error('Time:      ', time, 'ms');\n    console.error('Memory:    ', (mem / (1024 * 1024)).toFixed(3), 'MB');\n}\n\nfunction showParseError(source, filename, details, message) {\n    function processLines(start, end) {\n        return lines.slice(start, end).map(function(line, idx) {\n            var num = String(start + idx + 1);\n\n            while (num.length < maxNumLength) {\n                num = ' ' + num;\n            }\n\n            return num + ' |' + line;\n        }).join('\\n');\n    }\n\n    var lines = source.split(/\\n|\\r\\n?|\\f/);\n    var column = details.column;\n    var line = details.line;\n    var startLine = Math.max(1, line - 2);\n    var endLine = Math.min(line + 2, lines.length + 1);\n    var maxNumLength = Math.max(4, String(endLine).length) + 1;\n\n    console.error('\\nParse error ' + filename + ': ' + message);\n    console.error(processLines(startLine - 1, line));\n    console.error(new Array(column + maxNumLength + 2).join('-') + '^');\n    console.error(processLines(line, endLine));\n    console.error();\n}\n\nfunction debugLevel(level) {\n    // level is undefined when no param -> 1\n    return isNaN(level) ? 1 : Math.max(Number(level), 0);\n}\n\nfunction resolveSourceMap(source, inputMap, map, inputFile, outputFile) {\n    var inputMapContent = null;\n    var inputMapFile = null;\n    var outputMapFile = null;\n\n    switch (map) {\n        case 'none':\n            // don't generate source map\n            map = false;\n            inputMap = 'none';\n            break;\n\n        case 'inline':\n            // nothing to do\n            break;\n\n        case 'file':\n            if (!outputFile) {\n                console.error('Output filename should be specified when `--map file` is used');\n                process.exit(2);\n            }\n\n            outputMapFile = outputFile + '.map';\n            break;\n\n        default:\n            // process filename\n            if (map) {\n                // check path is reachable\n                if (!fs.existsSync(path.dirname(map))) {\n                    console.error('Directory for map file should exists:', path.dirname(path.resolve(map)));\n                    process.exit(2);\n                }\n\n                // resolve to absolute path\n                outputMapFile = path.resolve(process.cwd(), map);\n            }\n    }\n\n    switch (inputMap) {\n        case 'none':\n            // nothing to do\n            break;\n\n        case 'auto':\n            if (map) {\n                // try fetch source map from source\n                var inputMapComment = source.match(/\\/\\*# sourceMappingURL=(\\S+)\\s*\\*\\/\\s*$/);\n\n                if (inputFile === '<stdin>') {\n                    inputFile = false;\n                }\n\n                if (inputMapComment) {\n                    // if comment found – value is filename or base64-encoded source map\n                    inputMapComment = inputMapComment[1];\n\n                    if (inputMapComment.substr(0, 5) === 'data:') {\n                        // decode source map content from comment\n                        inputMapContent = new Buffer(inputMapComment.substr(inputMapComment.indexOf('base64,') + 7), 'base64').toString();\n                    } else {\n                        // value is filename – resolve it as absolute path\n                        if (inputFile) {\n                            inputMapFile = path.resolve(path.dirname(inputFile), inputMapComment);\n                        }\n                    }\n                } else {\n                    // comment doesn't found - look up file with `.map` extension nearby input file\n                    if (inputFile && fs.existsSync(inputFile + '.map')) {\n                        inputMapFile = inputFile + '.map';\n                    }\n                }\n\n            }\n            break;\n\n        default:\n            if (inputMap) {\n                inputMapFile = inputMap;\n            }\n    }\n\n    // source map placed in external file\n    if (inputMapFile) {\n        inputMapContent = fs.readFileSync(inputMapFile, 'utf8');\n    }\n\n    return {\n        input: inputMapContent,\n        inputFile: inputMapFile || (inputMapContent ? '<inline>' : false),\n        output: map,\n        outputFile: outputMapFile\n    };\n}\n\nfunction processCommentsOption(value) {\n    switch (value) {\n        case 'exclamation':\n        case 'first-exclamation':\n        case 'none':\n            return value;\n    }\n\n    console.error('Wrong value for `comments` option: %s', value);\n    process.exit(2);\n}\n\nvar command = cli.create('csso', '[input] [output]')\n    .version(require('../package.json').version)\n    .option('-i, --input <filename>', 'Input file')\n    .option('-o, --output <filename>', 'Output file (result outputs to stdout if not set)')\n    .option('-m, --map <destination>', 'Generate source map: none (default), inline, file or <filename>', 'none')\n    .option('-u, --usage <filenane>', 'Usage data file')\n    .option('--input-map <source>', 'Input source map: none, auto (default) or <filename>', 'auto')\n    .option('--restructure-off', 'Turns structure minimization off')\n    .option('--comments <value>', 'Comments to keep: exclamation (default), first-exclamation or none', 'exclamation')\n    .option('--stat', 'Output statistics in stderr')\n    .option('--debug [level]', 'Output intermediate state of CSS during compression', debugLevel, 0)\n    .action(function(args) {\n        var options = this.values;\n        var inputFile = options.input || args[0];\n        var outputFile = options.output || args[1];\n        var usageFile = options.usage;\n        var usageData = false;\n        var map = options.map;\n        var inputMap = options.inputMap;\n        var structureOptimisationOff = options.restructureOff;\n        var comments = processCommentsOption(options.comments);\n        var debug = options.debug;\n        var statistics = options.stat;\n        var inputStream;\n\n        if (process.stdin.isTTY && !inputFile && !outputFile) {\n            this.showHelp();\n            return;\n        }\n\n        if (!inputFile) {\n            inputFile = '<stdin>';\n            inputStream = process.stdin;\n        } else {\n            inputFile = path.resolve(process.cwd(), inputFile);\n            inputStream = fs.createReadStream(inputFile);\n        }\n\n        if (outputFile) {\n            outputFile = path.resolve(process.cwd(), outputFile);\n        }\n\n        if (usageFile) {\n            if (!fs.existsSync(usageFile)) {\n                console.error('Usage data file doesn\\'t found (%s)', usageFile);\n                process.exit(2);\n            }\n\n            usageData = fs.readFileSync(usageFile, 'utf-8');\n\n            try {\n                usageData = JSON.parse(usageData);\n            } catch (e) {\n                console.error('Usage data parse error (%s)', usageFile);\n                process.exit(2);\n            }\n        }\n\n        readFromStream(inputStream, function(source) {\n            var time = process.hrtime();\n            var mem = process.memoryUsage().heapUsed;\n            var sourceMap = resolveSourceMap(source, inputMap, map, inputFile, outputFile);\n            var sourceMapAnnotation = '';\n            var result;\n\n            // main action\n            try {\n                result = csso.minify(source, {\n                    filename: inputFile,\n                    sourceMap: sourceMap.output,\n                    usage: usageData,\n                    restructure: !structureOptimisationOff,\n                    comments: comments,\n                    debug: debug\n                });\n\n                // for backward capability minify returns a string\n                if (typeof result === 'string') {\n                    result = {\n                        css: result,\n                        map: null\n                    };\n                }\n            } catch (e) {\n                if (e.parseError) {\n                    showParseError(source, inputFile, e.parseError, e.message);\n                    if (!debug) {\n                        process.exit(2);\n                    }\n                }\n\n                throw e;\n            }\n\n            if (sourceMap.output && result.map) {\n                // apply input map\n                if (sourceMap.input) {\n                    result.map.applySourceMap(\n                        new SourceMapConsumer(sourceMap.input),\n                        inputFile\n                    );\n                }\n\n                // add source map to result\n                if (sourceMap.outputFile) {\n                    // write source map to file\n                    fs.writeFileSync(sourceMap.outputFile, result.map.toString(), 'utf-8');\n                    sourceMapAnnotation = '\\n' +\n                        '/*# sourceMappingURL=' +\n                        path.relative(outputFile ? path.dirname(outputFile) : process.cwd(), sourceMap.outputFile) +\n                        ' */';\n                } else {\n                    // inline source map\n                    sourceMapAnnotation = '\\n' +\n                        '/*# sourceMappingURL=data:application/json;base64,' +\n                        new Buffer(result.map.toString()).toString('base64') +\n                        ' */';\n                }\n\n                result.css += sourceMapAnnotation;\n            }\n\n            // output result\n            if (outputFile) {\n                fs.writeFileSync(outputFile, result.css, 'utf-8');\n            } else {\n                console.log(result.css);\n            }\n\n            // output statistics\n            if (statistics) {\n                var timeDiff = process.hrtime(time);\n                showStat(\n                    path.relative(process.cwd(), inputFile),\n                    source.length,\n                    result.css.length,\n                    sourceMap.inputFile,\n                    sourceMapAnnotation.length,\n                    parseInt(timeDiff[0] * 1e3 + timeDiff[1] / 1e6),\n                    process.memoryUsage().heapUsed - mem\n                );\n            }\n        });\n    });\n\nmodule.exports = {\n    run: command.run.bind(command),\n    isCliError: function(err) {\n        return err instanceof cli.Error;\n    }\n};\n"]}