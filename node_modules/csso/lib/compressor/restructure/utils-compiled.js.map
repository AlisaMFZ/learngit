{"version":3,"sources":["utils.js"],"names":[],"mappings":"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","file":"utils-compiled.js","sourcesContent":["var hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction isEqualLists(a, b) {\n    var cursor1 = a.head;\n    var cursor2 = b.head;\n\n    while (cursor1 !== null && cursor2 !== null && cursor1.data.id === cursor2.data.id) {\n        cursor1 = cursor1.next;\n        cursor2 = cursor2.next;\n    }\n\n    return cursor1 === null && cursor2 === null;\n}\n\nfunction isEqualDeclarations(a, b) {\n    var cursor1 = a.head;\n    var cursor2 = b.head;\n\n    while (cursor1 !== null && cursor2 !== null && cursor1.data.id === cursor2.data.id) {\n        cursor1 = cursor1.next;\n        cursor2 = cursor2.next;\n    }\n\n    return cursor1 === null && cursor2 === null;\n}\n\nfunction compareDeclarations(declarations1, declarations2) {\n    var result = {\n        eq: [],\n        ne1: [],\n        ne2: [],\n        ne2overrided: []\n    };\n\n    var fingerprints = Object.create(null);\n    var declarations2hash = Object.create(null);\n\n    for (var cursor = declarations2.head; cursor; cursor = cursor.next)  {\n        declarations2hash[cursor.data.id] = true;\n    }\n\n    for (var cursor = declarations1.head; cursor; cursor = cursor.next)  {\n        var data = cursor.data;\n\n        if (data.fingerprint) {\n            fingerprints[data.fingerprint] = data.value.important;\n        }\n\n        if (declarations2hash[data.id]) {\n            declarations2hash[data.id] = false;\n            result.eq.push(data);\n        } else {\n            result.ne1.push(data);\n        }\n    }\n\n    for (var cursor = declarations2.head; cursor; cursor = cursor.next)  {\n        var data = cursor.data;\n\n        if (declarations2hash[data.id]) {\n            // if declarations1 has overriding declaration, this is not a difference\n            // but take in account !important - prev should be equal or greater than follow\n            if (hasOwnProperty.call(fingerprints, data.fingerprint) &&\n                Number(fingerprints[data.fingerprint]) >= Number(data.value.important)) {\n                result.ne2overrided.push(data);\n            } else {\n                result.ne2.push(data);\n            }\n        }\n    }\n\n    return result;\n}\n\nfunction addSelectors(dest, source) {\n    source.each(function(sourceData) {\n        var newStr = sourceData.id;\n        var cursor = dest.head;\n\n        while (cursor) {\n            var nextStr = cursor.data.id;\n\n            if (nextStr === newStr) {\n                return;\n            }\n\n            if (nextStr > newStr) {\n                break;\n            }\n\n            cursor = cursor.next;\n        }\n\n        dest.insert(dest.createItem(sourceData), cursor);\n    });\n\n    return dest;\n}\n\n// check if simpleselectors has no equal specificity and element selector\nfunction hasSimilarSelectors(selectors1, selectors2) {\n    return selectors1.some(function(a) {\n        return selectors2.some(function(b) {\n            return a.compareMarker === b.compareMarker;\n        });\n    });\n}\n\n// test node can't to be skipped\nfunction unsafeToSkipNode(node) {\n    switch (node.type) {\n        case 'Ruleset':\n            // unsafe skip ruleset with selector similarities\n            return hasSimilarSelectors(node.selector.selectors, this);\n\n        case 'Atrule':\n            // can skip at-rules with blocks\n            if (node.block) {\n                // non-stylesheet blocks are safe to skip since have no selectors\n                if (node.block.type !== 'StyleSheet') {\n                    return false;\n                }\n\n                // unsafe skip at-rule if block contains something unsafe to skip\n                return node.block.rules.some(unsafeToSkipNode, this);\n            }\n            break;\n    }\n\n    // unsafe by default\n    return true;\n}\n\nmodule.exports = {\n    isEqualLists: isEqualLists,\n    isEqualDeclarations: isEqualDeclarations,\n    compareDeclarations: compareDeclarations,\n    addSelectors: addSelectors,\n    hasSimilarSelectors: hasSimilarSelectors,\n    unsafeToSkipNode: unsafeToSkipNode\n};\n"]}