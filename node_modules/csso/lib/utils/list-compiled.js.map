{"version":3,"sources":["list.js"],"names":[],"mappings":"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","file":"list-compiled.js","sourcesContent":["//\n//            item        item        item        item\n//          /------\\    /------\\    /------\\    /------\\\n//          | data |    | data |    | data |    | data |\n//  null <--+-prev |<---+-prev |<---+-prev |<---+-prev |\n//          | next-+--->| next-+--->| next-+--->| next-+--> null\n//          \\------/    \\------/    \\------/    \\------/\n//             ^                                    ^\n//             |                list                |\n//             |              /------\\              |\n//             \\--------------+-head |              |\n//                            | tail-+--------------/\n//                            \\------/\n//\n\nfunction createItem(data) {\n    return {\n        data: data,\n        next: null,\n        prev: null\n    };\n}\n\nvar List = function(values) {\n    this.cursor = null;\n    this.head = null;\n    this.tail = null;\n\n    if (Array.isArray(values)) {\n        var cursor = null;\n\n        for (var i = 0; i < values.length; i++) {\n            var item = createItem(values[i]);\n\n            if (cursor !== null) {\n                cursor.next = item;\n            } else {\n                this.head = item;\n            }\n\n            item.prev = cursor;\n            cursor = item;\n        }\n\n        this.tail = cursor;\n    }\n};\n\nObject.defineProperty(List.prototype, 'size', {\n    get: function() {\n        var size = 0;\n        var cursor = this.head;\n\n        while (cursor) {\n            size++;\n            cursor = cursor.next;\n        }\n\n        return size;\n    }\n});\n\nList.createItem = createItem;\nList.prototype.createItem = createItem;\n\nList.prototype.toArray = function() {\n    var cursor = this.head;\n    var result = [];\n\n    while (cursor) {\n        result.push(cursor.data);\n        cursor = cursor.next;\n    }\n\n    return result;\n};\nList.prototype.toJSON = function() {\n    return this.toArray();\n};\n\nList.prototype.isEmpty = function() {\n    return this.head === null;\n};\n\nList.prototype.first = function() {\n    return this.head && this.head.data;\n};\n\nList.prototype.last = function() {\n    return this.tail && this.tail.data;\n};\n\nList.prototype.each = function(fn, context) {\n    var item;\n    var cursor = {\n        prev: null,\n        next: this.head,\n        cursor: this.cursor\n    };\n\n    if (context === undefined) {\n        context = this;\n    }\n\n    // push cursor\n    this.cursor = cursor;\n\n    while (cursor.next !== null) {\n        item = cursor.next;\n        cursor.next = item.next;\n\n        fn.call(context, item.data, item, this);\n    }\n\n    // pop cursor\n    this.cursor = this.cursor.cursor;\n};\n\nList.prototype.eachRight = function(fn, context) {\n    var item;\n    var cursor = {\n        prev: this.tail,\n        next: null,\n        cursor: this.cursor\n    };\n\n    if (context === undefined) {\n        context = this;\n    }\n\n    // push cursor\n    this.cursor = cursor;\n\n    while (cursor.prev !== null) {\n        item = cursor.prev;\n        cursor.prev = item.prev;\n\n        fn.call(context, item.data, item, this);\n    }\n\n    // pop cursor\n    this.cursor = this.cursor.cursor;\n};\n\nList.prototype.nextUntil = function(start, fn, context) {\n    if (start === null) {\n        return;\n    }\n\n    var item;\n    var cursor = {\n        prev: null,\n        next: start,\n        cursor: this.cursor\n    };\n\n    if (context === undefined) {\n        context = this;\n    }\n\n    // push cursor\n    this.cursor = cursor;\n\n    while (cursor.next !== null) {\n        item = cursor.next;\n        cursor.next = item.next;\n\n        if (fn.call(context, item.data, item, this)) {\n            break;\n        }\n    }\n\n    // pop cursor\n    this.cursor = this.cursor.cursor;\n};\n\nList.prototype.prevUntil = function(start, fn, context) {\n    if (start === null) {\n        return;\n    }\n\n    var item;\n    var cursor = {\n        prev: start,\n        next: null,\n        cursor: this.cursor\n    };\n\n    if (context === undefined) {\n        context = this;\n    }\n\n    // push cursor\n    this.cursor = cursor;\n\n    while (cursor.prev !== null) {\n        item = cursor.prev;\n        cursor.prev = item.prev;\n\n        if (fn.call(context, item.data, item, this)) {\n            break;\n        }\n    }\n\n    // pop cursor\n    this.cursor = this.cursor.cursor;\n};\n\nList.prototype.some = function(fn, context) {\n    var cursor = this.head;\n\n    if (context === undefined) {\n        context = this;\n    }\n\n    while (cursor !== null) {\n        if (fn.call(context, cursor.data, cursor, this)) {\n            return true;\n        }\n\n        cursor = cursor.next;\n    }\n\n    return false;\n};\n\nList.prototype.map = function(fn, context) {\n    var result = [];\n    var cursor = this.head;\n\n    if (context === undefined) {\n        context = this;\n    }\n\n    while (cursor !== null) {\n        result.push(fn.call(context, cursor.data, cursor, this));\n        cursor = cursor.next;\n    }\n\n    return result;\n};\n\nList.prototype.copy = function() {\n    var result = new List();\n    var cursor = this.head;\n\n    while (cursor !== null) {\n        result.insert(createItem(cursor.data));\n        cursor = cursor.next;\n    }\n\n    return result;\n};\n\nList.prototype.updateCursors = function(prevOld, prevNew, nextOld, nextNew) {\n    var cursor = this.cursor;\n\n    while (cursor !== null) {\n        if (prevNew === true || cursor.prev === prevOld) {\n            cursor.prev = prevNew;\n        }\n\n        if (nextNew === true || cursor.next === nextOld) {\n            cursor.next = nextNew;\n        }\n\n        cursor = cursor.cursor;\n    }\n};\n\nList.prototype.insert = function(item, before) {\n    if (before !== undefined && before !== null) {\n        // prev   before\n        //      ^\n        //     item\n        this.updateCursors(before.prev, item, before, item);\n\n        if (before.prev === null) {\n            // insert to the beginning of list\n            if (this.head !== before) {\n                throw new Error('before doesn\\'t below to list');\n            }\n\n            // since head points to before therefore list doesn't empty\n            // no need to check tail\n            this.head = item;\n            before.prev = item;\n            item.next = before;\n\n            this.updateCursors(null, item);\n        } else {\n\n            // insert between two items\n            before.prev.next = item;\n            item.prev = before.prev;\n\n            before.prev = item;\n            item.next = before;\n        }\n    } else {\n        // tail\n        //      ^\n        //     item\n        this.updateCursors(this.tail, item, null, item);\n\n        // insert to end of the list\n        if (this.tail !== null) {\n            // if list has a tail, then it also has a head, but head doesn't change\n\n            // last item -> new item\n            this.tail.next = item;\n\n            // last item <- new item\n            item.prev = this.tail;\n        } else {\n            // if list has no a tail, then it also has no a head\n            // in this case points head to new item\n            this.head = item;\n        }\n\n        // tail always start point to new item\n        this.tail = item;\n    }\n};\n\nList.prototype.remove = function(item) {\n    //      item\n    //       ^\n    // prev     next\n    this.updateCursors(item, item.prev, item, item.next);\n\n    if (item.prev !== null) {\n        item.prev.next = item.next;\n    } else {\n        if (this.head !== item) {\n            throw new Error('item doesn\\'t below to list');\n        }\n\n        this.head = item.next;\n    }\n\n    if (item.next !== null) {\n        item.next.prev = item.prev;\n    } else {\n        if (this.tail !== item) {\n            throw new Error('item doesn\\'t below to list');\n        }\n\n        this.tail = item.prev;\n    }\n\n    item.prev = null;\n    item.next = null;\n\n    return item;\n};\n\nList.prototype.appendList = function(list) {\n    // ignore empty lists\n    if (list.head === null) {\n        return;\n    }\n\n    this.updateCursors(this.tail, list.tail, null, list.head);\n\n    // insert to end of the list\n    if (this.tail !== null) {\n        // if destination list has a tail, then it also has a head,\n        // but head doesn't change\n\n        // dest tail -> source head\n        this.tail.next = list.head;\n\n        // dest tail <- source head\n        list.head.prev = this.tail;\n    } else {\n        // if list has no a tail, then it also has no a head\n        // in this case points head to new item\n        this.head = list.head;\n    }\n\n    // tail always start point to new item\n    this.tail = list.tail;\n\n    list.head = null;\n    list.tail = null;\n};\n\nmodule.exports = List;\n"]}