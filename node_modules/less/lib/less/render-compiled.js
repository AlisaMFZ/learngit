'use strict';

var _promise = require('babel-runtime/core-js/promise');

var _promise2 = _interopRequireDefault(_promise);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var PromiseConstructor;

module.exports = function (environment, ParseTree, ImportManager) {
    var render = function render(input, options, callback) {
        if (typeof options === 'function') {
            callback = options;
            options = {};
        }

        if (!callback) {
            if (!PromiseConstructor) {
                PromiseConstructor = typeof _promise2.default === 'undefined' ? require('promise') : _promise2.default;
            }
            var self = this;
            return new PromiseConstructor(function (resolve, reject) {
                render.call(self, input, options, function (err, output) {
                    if (err) {
                        reject(err);
                    } else {
                        resolve(output);
                    }
                });
            });
        } else {
            this.parse(input, options, function (err, root, imports, options) {
                if (err) {
                    return callback(err);
                }

                var result;
                try {
                    var parseTree = new ParseTree(root, imports);
                    result = parseTree.toCSS(options);
                } catch (err) {
                    return callback(err);
                }

                callback(null, result);
            });
        }
    };

    return render;
};

//# sourceMappingURL=render-compiled.js.map